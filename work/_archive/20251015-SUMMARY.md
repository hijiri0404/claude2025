# 作業概要 - 20251015

## 📅 作業情報
- **作業日**: 2025-10-15 (JST)
- **セッション時間**: 14:37 - 14:54 (JST)
- **主要タスク**: DNS削除時TTL動作とネガティブキャッシュの詳細調査

## 📁 生成ファイル一覧

### 主要成果物
- `DNS削除時TTL動作とネガティブキャッシュ調査結果.md` - DNS削除時のTTL動作とネガティブキャッシュの包括的調査結果

## 🎯 完了したタスク
- [x] DNS削除時のキャッシュ動作の調査
- [x] TXTレコードTTL vs SOAの使い分けの解説
- [x] 実際のdigで確認
- [x] ネガティブキャッシュの詳細解説
- [x] 実証実験でネガティブキャッシュの挙動確認
- [x] ネガティブキャッシュの制限と例外説明
- [x] 理論と実際の相違点整理
- [x] 調査結果のMDファイル作成

## 📝 主要な発見・結論

### DNS削除時のTTL動作
- **結論**: 削除反映には元TXTレコードのTTL（60秒）が使用される
- **SOAのMinimum TTL（86400秒）は削除反映タイミングに影響しない**
- 実測データで完全に実証（削除実行から約17秒後にNXDOMAIN開始）

### ネガティブキャッシュの実際
- **効率化効果**: 完全に存在しないレコードで33倍高速化確認
- **新規作成の阻害なし**: NXDOMAINキャッシュがあっても16秒で新レコード反映
- **理論と実際の相違**: DNS実装は効率性と正確性のバランスを取る複雑な動作

### 重要な気づき
- RFC理論通りの単純な動作ではない
- DNS実装により適応的なキャッシュ戦略を採用
- 実用的には問題なく動作する設計

## 🧪 実施した実証実験

### 実験1: DNS削除時のTTL動作検証
- 継続監視によるTTLカウントダウンの確認
- 削除実行タイミングと反映タイミングの精密測定

### 実験2: ネガティブキャッシュ効果測定
- 完全に存在しないレコードでの33倍高速化確認
- 削除→再作成パターンでの動作検証

### 実験3: 理論と実際の相違点検証
- 予想と異なるキャッシュ動作の発見
- DNS実装の複雑性の確認

## 📋 使用したコマンド・技術

### 主要コマンド
```bash
# SOA確認
dig hijiri0404.link SOA +noall +answer

# TTL付き継続監視
while true; do echo "$(date '+%Y-%m-%d %H:%M:%S') $(dig testh.hijiri0404.link TXT +noall +answer)"; sleep 5; done

# Route53レコード操作
aws route53 change-resource-record-sets --hosted-zone-id Z05608792OMRUEGE6GF3A --change-batch

# 応答時間測定
time dig [レコード名] TXT > /dev/null 2>&1
```

### 対象ドメイン
- **メインドメイン**: hijiri0404.link
- **調査対象**: testh.hijiri0404.link TXT レコード
- **Route53 Hosted Zone ID**: Z05608792OMRUEGE6GF3A

## 🔗 関連情報
- **前セッション**: S3クロスアカウント日次ファイル転送分析
- **継続調査**: DNS TTL動作の理論と実際の相違点
- **技術領域**: DNS, Route53, RFC仕様, キャッシュ動作

## 📚 技術的価値
この調査により、DNSの理論と実際の実装における相違点が明確になり、実用的なDNS理解に大きく貢献する結果を得ました。特に、削除時のTTL動作については実測による明確な証明ができました。

---

**注**: この調査は前セッションから継続したDNS調査の完結編として、理論と実際の両面から包括的にDNS動作を解明しました。