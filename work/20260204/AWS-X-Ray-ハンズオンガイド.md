# AWS X-Ray ãƒãƒ³ã‚ºã‚ªãƒ³ã‚¬ã‚¤ãƒ‰

> **å¯¾è±¡**: AWS DevOps Professional (DOP-C02) è©¦é¨“å¯¾ç­–
> **å‰æçŸ¥è­˜**: AWSåŸºç¤ã€Lambdaã€ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã®æ¦‚å¿µ
> **æ‰€è¦æ™‚é–“**: ç´„2æ™‚é–“

---

## ç›®æ¬¡

1. [X-Rayæ¦‚è¦](#1-x-rayæ¦‚è¦)
2. [ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°ã®åŸºæœ¬æ¦‚å¿µ](#2-ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°ã®åŸºæœ¬æ¦‚å¿µ)
3. [X-Ray SDK / ãƒ‡ãƒ¼ãƒ¢ãƒ³](#3-x-ray-sdk--ãƒ‡ãƒ¼ãƒ¢ãƒ³)
4. [ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ«](#4-ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ«)
5. [ã‚µãƒ¼ãƒ“ã‚¹ãƒãƒƒãƒ—ã¨ãƒˆãƒ¬ãƒ¼ã‚¹åˆ†æ](#5-ã‚µãƒ¼ãƒ“ã‚¹ãƒãƒƒãƒ—ã¨ãƒˆãƒ¬ãƒ¼ã‚¹åˆ†æ)
6. [AWS ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆ](#6-aws-ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆ)
7. [ãƒãƒ³ã‚ºã‚ªãƒ³æ¼”ç¿’](#7-ãƒãƒ³ã‚ºã‚ªãƒ³æ¼”ç¿’)
8. [DOPè©¦é¨“å¯¾ç­–ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ](#8-dopè©¦é¨“å¯¾ç­–ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ)

---

## 1. X-Rayæ¦‚è¦

### 1.1 X-Rayã¨ã¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          AWS X-Ray                                   â”‚
â”‚                   åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹                            â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    ãƒˆãƒ¬ãƒ¼ã‚¹åé›†                                â”‚ â”‚
â”‚  â”‚                                                                â”‚ â”‚
â”‚  â”‚  Client â”€â”€â–¶ API GW â”€â”€â–¶ Lambda â”€â”€â–¶ DynamoDB                   â”‚ â”‚
â”‚  â”‚    â”‚           â”‚          â”‚           â”‚                        â”‚ â”‚
â”‚  â”‚    â–¼           â–¼          â–¼           â–¼                        â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”                      â”‚ â”‚
â”‚  â”‚  â”‚Seg â”‚    â”‚Seg â”‚    â”‚Seg â”‚      â”‚Sub â”‚                      â”‚ â”‚
â”‚  â”‚  â”‚mentâ”‚    â”‚mentâ”‚    â”‚mentâ”‚      â”‚seg â”‚                      â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”˜                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                      â”‚
â”‚                              â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    åˆ†æãƒ»å¯è¦–åŒ–                                â”‚ â”‚
â”‚  â”‚                                                                â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚  â”‚  â”‚  Service     â”‚  â”‚   Trace      â”‚  â”‚   Analytics  â”‚        â”‚ â”‚
â”‚  â”‚  â”‚   Map        â”‚  â”‚   Timeline   â”‚  â”‚   (ãƒ•ã‚£ãƒ«ã‚¿) â”‚        â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 DOPè©¦é¨“ã§ã®é‡è¦ãƒã‚¤ãƒ³ãƒˆ

| ãƒˆãƒ”ãƒƒã‚¯ | é‡è¦åº¦ | å‡ºé¡Œãƒ‘ã‚¿ãƒ¼ãƒ³ |
|---------|--------|-------------|
| **ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ«** | â˜…â˜…â˜…â˜…â˜… | ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«è¨­å®š |
| **ã‚µãƒ¼ãƒ“ã‚¹ãƒãƒƒãƒ—** | â˜…â˜…â˜…â˜…â˜† | ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ç‰¹å®š |
| **ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ/ã‚µãƒ–ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ** | â˜…â˜…â˜…â˜…â˜† | ãƒˆãƒ¬ãƒ¼ã‚¹æ§‹é€ ã®ç†è§£ |
| **X-Ray + Lambda** | â˜…â˜…â˜…â˜…â˜… | ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚° |
| **X-Ray + ECS** | â˜…â˜…â˜…â˜…â˜† | ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ |
| **X-Rayã‚°ãƒ«ãƒ¼ãƒ—** | â˜…â˜…â˜…â˜†â˜† | ãƒ•ã‚£ãƒ«ã‚¿å¼ |

---

## 2. ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°ã®åŸºæœ¬æ¦‚å¿µ

### 2.1 ãƒˆãƒ¬ãƒ¼ã‚¹ã®æ§‹é€ 

```
ã€ãƒˆãƒ¬ãƒ¼ã‚¹æ§‹é€ ã€‘

Traceï¼ˆãƒˆãƒ¬ãƒ¼ã‚¹ï¼‰= 1ã¤ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å…¨ä½“åƒ
â”‚
â”œâ”€ Segmentï¼ˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆï¼‰= 1ã¤ã®ã‚µãƒ¼ãƒ“ã‚¹ã®å‡¦ç†
â”‚   â”‚
â”‚   â”œâ”€ Subsegmentï¼ˆã‚µãƒ–ã‚»ã‚°ãƒ¡ãƒ³ãƒˆï¼‰= å¤–éƒ¨å‘¼å‡ºã—
â”‚   â”‚   â”œâ”€ AWS SDKå‘¼å‡ºã— (DynamoDB, S3ç­‰)
â”‚   â”‚   â”œâ”€ HTTPå‘¼å‡ºã— (å¤–éƒ¨API)
â”‚   â”‚   â””â”€ SQL ã‚¯ã‚¨ãƒª
â”‚   â”‚
â”‚   â”œâ”€ Annotationsï¼ˆã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
â”‚   â”‚   â””â”€ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä»˜ãã‚­ãƒ¼ãƒãƒªãƒ¥ãƒ¼ï¼ˆæ¤œç´¢å¯èƒ½ï¼‰
â”‚   â”‚
â”‚   â”œâ”€ Metadataï¼ˆãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼‰
â”‚   â”‚   â””â”€ éã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ã‚­ãƒ¼ãƒãƒªãƒ¥ãƒ¼ï¼ˆæ¤œç´¢ä¸å¯ï¼‰
â”‚   â”‚
â”‚   â””â”€ Errors / Faults / Throttles
â”‚       â”œâ”€ Error: 4xx ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¨ãƒ©ãƒ¼
â”‚       â”œâ”€ Fault: 5xx ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼
â”‚       â””â”€ Throttle: 429 ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°
â”‚
â””â”€ Trace ID: 1-{hex_timestamp}-{96bit_random}
    ä¾‹: 1-67a12345-abcdef1234567890abcdef12
```

### 2.2 ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³è¡¨ç¤º

```
ã€ãƒˆãƒ¬ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã€‘

Time: 0ms    100ms   200ms   300ms   400ms   500ms
       |       |       |       |       |       |
API GW â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                              (200ms)
  â””â”€ Lambda     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ             (350ms)
       â”œâ”€ DynamoDB Get    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                     (50ms)
       â”œâ”€ DynamoDB Put        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ              (80ms)
       â””â”€ SNS Publish               â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ         (70ms)
                                          â””â”€ Lambda2  â–ˆâ–ˆâ–ˆâ–ˆ  (30ms)

Total: 500ms
Bottleneck: Lambda (350ms) â†’ DynamoDB Put (80ms)
```

### 2.3 Annotations vs Metadata

| é …ç›® | Annotations | Metadata |
|------|------------|----------|
| **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹** | ã‚ã‚Šï¼ˆæ¤œç´¢å¯èƒ½ï¼‰ | ãªã— |
| **ãƒ‡ãƒ¼ã‚¿å‹** | String, Number, Boolean | ä»»æ„ï¼ˆJSONï¼‰ |
| **ç”¨é€”** | ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ»æ¤œç´¢ | ãƒ‡ãƒãƒƒã‚°è©³ç´°æƒ…å ± |
| **åˆ¶é™** | 50å€‹/ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ | ã‚µã‚¤ã‚ºåˆ¶é™ã®ã¿ |
| **ã‚³ã‚¹ãƒˆ** | ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åˆ†ã‚„ã‚„é«˜ã„ | ä½ã„ |

```python
# Annotationsï¼ˆæ¤œç´¢å¯èƒ½ï¼‰
subsegment.put_annotation("user_id", "user-123")
subsegment.put_annotation("order_type", "premium")

# Metadataï¼ˆæ¤œç´¢ä¸å¯ã€è©³ç´°æƒ…å ±ï¼‰
subsegment.put_metadata("order_details", {
    "items": ["item-1", "item-2"],
    "total": 150.00
})
```

---

## 3. X-Ray SDK / ãƒ‡ãƒ¼ãƒ¢ãƒ³

### 3.1 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
ã€X-Ray ãƒ‡ãƒ¼ãƒ¢ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€‘

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚    X-Ray SDK       â”‚                       â”‚
â”‚  â”‚                    â”‚                       â”‚
â”‚  â”‚  ãƒ»è‡ªå‹•è¨ˆè£…        â”‚  UDP 2000            â”‚
â”‚  â”‚  ãƒ»æ‰‹å‹•è¨ˆè£…        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ãƒ»ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°    â”‚                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚    â”‚
â”‚                                          â–¼    â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                              â”‚  X-Ray      â”‚  â”‚
â”‚                              â”‚  Daemon     â”‚  â”‚
â”‚                              â”‚  (UDPâ†’HTTPS)â”‚  â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚ HTTPS
                                      â–¼
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                             â”‚   X-Ray API    â”‚
                             â”‚   Service      â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 SDKè¨€èªã‚µãƒãƒ¼ãƒˆ

| è¨€èª | SDK | ä¸»ãªè¨ˆè£…æ–¹æ³• |
|------|-----|-------------|
| Python | `aws-xray-sdk` | ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢/ãƒ‘ãƒƒãƒ |
| Node.js | `aws-xray-sdk` | Express/Hapi ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ |
| Java | `aws-xray-sdk-java` | ã‚µãƒ¼ãƒ–ãƒ¬ãƒƒãƒˆãƒ•ã‚£ãƒ«ã‚¿ |
| .NET | `AWSXRayRecorder` | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒãƒ³ãƒ‰ãƒ© |
| Go | `aws-xray-sdk-go` | ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ |

### 3.3 SDKä½¿ç”¨ä¾‹ï¼ˆPythonï¼‰

```python
from aws_xray_sdk.core import xray_recorder
from aws_xray_sdk.core import patch_all

# AWS SDKã‚’è‡ªå‹•è¨ˆè£…ï¼ˆDynamoDB, S3ç­‰ã®å‘¼å‡ºã—ã‚’è‡ªå‹•ãƒˆãƒ¬ãƒ¼ã‚¹ï¼‰
patch_all()

# ã‚«ã‚¹ã‚¿ãƒ ã‚µãƒ–ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ
@xray_recorder.capture('process_order')
def process_order(order_id):
    # ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¿½åŠ ï¼ˆæ¤œç´¢å¯èƒ½ï¼‰
    subsegment = xray_recorder.current_subsegment()
    subsegment.put_annotation('order_id', order_id)

    # å‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯...
    result = dynamodb.get_item(TableName='orders', Key={'id': {'S': order_id}})

    # ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è¿½åŠ 
    subsegment.put_metadata('result', result)

    return result
```

### 3.4 ECSã§ã®ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³

```json
// ECSã‚¿ã‚¹ã‚¯å®šç¾©ï¼ˆX-Rayãƒ‡ãƒ¼ãƒ¢ãƒ³ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ï¼‰
{
  "containerDefinitions": [
    {
      "name": "app",
      "image": "my-app:latest",
      "portMappings": [{"containerPort": 8080}],
      "environment": [
        {"name": "AWS_XRAY_DAEMON_ADDRESS", "value": "xray-daemon:2000"}
      ],
      "links": ["xray-daemon"]
    },
    {
      "name": "xray-daemon",
      "image": "amazon/aws-xray-daemon",
      "portMappings": [
        {"containerPort": 2000, "protocol": "udp"}
      ],
      "cpu": 32,
      "memoryReservation": 256
    }
  ]
}
```

---

## 4. ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ«

### 4.1 ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã®ä»•çµ„ã¿

```
ã€ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã€‘

å…¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚  100%
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
              ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°é©ç”¨
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–ˆâ–ˆâ–ˆâ–ˆ            â”‚                           â”‚  ~5%
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  è¨˜éŒ²ã•ã‚Œã‚‹ãƒˆãƒ¬ãƒ¼ã‚¹    ç ´æ£„

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ«ãƒ¼ãƒ«:
  reservoir (ãƒªã‚¶ãƒ¼ãƒ): 1ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ç§’ï¼ˆç¢ºå®Ÿã«è¨˜éŒ²ï¼‰
  rate (ãƒ¬ãƒ¼ãƒˆ): 5%ï¼ˆè¿½åŠ ã§ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ï¼‰
```

### 4.2 ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ«ãƒ¼ãƒ«

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ | èª¬æ˜ |
|----------|------------|------|
| **reservoir** | 1 | æ¯ç§’å¿…ãšè¨˜éŒ²ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•° |
| **rate** | 0.05 (5%) | ãƒªã‚¶ãƒ¼ãƒè¶…éåˆ†ã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ç‡ |

### 4.3 ã‚«ã‚¹ã‚¿ãƒ ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ«

```bash
# ã‚«ã‚¹ã‚¿ãƒ ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã®ä½œæˆ
aws xray create-sampling-rule \
  --sampling-rule '{
    "RuleName": "HighPriorityAPI",
    "Priority": 100,
    "FixedRate": 1.0,
    "ReservoirSize": 10,
    "ServiceName": "api-service",
    "ServiceType": "*",
    "Host": "*",
    "HTTPMethod": "POST",
    "URLPath": "/api/orders/*",
    "ResourceARN": "*",
    "Version": 1
  }'

# ã‚¨ãƒ©ãƒ¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’100%ãƒˆãƒ¬ãƒ¼ã‚¹
aws xray create-sampling-rule \
  --sampling-rule '{
    "RuleName": "AllErrors",
    "Priority": 50,
    "FixedRate": 1.0,
    "ReservoirSize": 100,
    "ServiceName": "*",
    "ServiceType": "*",
    "Host": "*",
    "HTTPMethod": "*",
    "URLPath": "*",
    "ResourceARN": "*",
    "Version": 1,
    "Attributes": {
      "error": "true"
    }
  }'
```

### 4.4 ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã®å„ªå…ˆåº¦

```
ã€ãƒ«ãƒ¼ãƒ«è©•ä¾¡é †åºã€‘

Priority: 1 (æœ€é«˜) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Priority: 10000 (æœ€ä½)

  Rule A          Rule B          Rule C          Default
  Priority: 50    Priority: 100   Priority: 200   Priority: 10000
  POST /orders    GET /health     * (å…¨ã¦)        * (å…¨ã¦)
  Rate: 100%      Rate: 0%        Rate: 10%       Rate: 5%
     â”‚               â”‚               â”‚               â”‚
     â–¼               â–¼               â–¼               â–¼
  æ³¨æ–‡APIã¯       ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯   ãã®ä»–ã¯         ä¸Šè¨˜ã«
  å…¨ã¦ãƒˆãƒ¬ãƒ¼ã‚¹    ã¯ãƒˆãƒ¬ãƒ¼ã‚¹ã—ãªã„  10%ãƒˆãƒ¬ãƒ¼ã‚¹     è©²å½“ã—ãªã„å ´åˆ
```

---

## 5. ã‚µãƒ¼ãƒ“ã‚¹ãƒãƒƒãƒ—ã¨ãƒˆãƒ¬ãƒ¼ã‚¹åˆ†æ

### 5.1 ã‚µãƒ¼ãƒ“ã‚¹ãƒãƒƒãƒ—

```
ã€ã‚µãƒ¼ãƒ“ã‚¹ãƒãƒƒãƒ—ã®èª­ã¿æ–¹ã€‘

     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ Client  â”‚
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
          â”‚
     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”   å¿œç­”æ™‚é–“/ã‚¨ãƒ©ãƒ¼ç‡ã‚’
     â”‚ API GW  â”‚   è‰²ã§è¡¨ç¤º
     â”‚ ğŸŸ¢ OK   â”‚   ğŸŸ¢ æ­£å¸¸
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   ğŸŸ¡ è­¦å‘Š
          â”‚        ğŸ”´ ã‚¨ãƒ©ãƒ¼
     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
     â”‚ Lambda  â”‚   ãƒãƒ¼ãƒ‰ã‚µã‚¤ã‚º =
     â”‚ ğŸŸ¡ é…å»¶ â”‚   ãƒªã‚¯ã‚¨ã‚¹ãƒˆé‡
     â””â”€â”€â”€â”¬â”€â”¬â”€â”€â”€â”˜
         â”‚ â”‚
    â”Œâ”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”
    â”‚           â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”
â”‚DynamoDBâ”‚  â”‚  SNS  â”‚   ã‚¨ãƒƒã‚¸ï¼ˆçŸ¢å°ï¼‰ã®å¤ªã• =
â”‚ ğŸŸ¢ OK  â”‚  â”‚ ğŸ”´ Errorâ”‚  ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯é‡
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ãƒ•ã‚£ãƒ«ã‚¿å¼

```bash
# ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ãŒ1ç§’ä»¥ä¸Šã®ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’æ¤œç´¢
responsetime > 1

# ã‚¨ãƒ©ãƒ¼ã‚’å«ã‚€ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’æ¤œç´¢
fault = true

# ç‰¹å®šã‚µãƒ¼ãƒ“ã‚¹ã®ãƒˆãƒ¬ãƒ¼ã‚¹
service("api-service")

# ç‰¹å®šã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒ•ã‚£ãƒ«ã‚¿
annotation.user_id = "user-123"

# è¤‡åˆæ¡ä»¶
service("api-service") AND responsetime > 2 AND fault = true

# HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã§ãƒ•ã‚£ãƒ«ã‚¿
http.status = 500

# URL ãƒ‘ã‚¹ã§ãƒ•ã‚£ãƒ«ã‚¿
http.url CONTAINS "/api/orders"
```

### 5.3 X-Rayã‚°ãƒ«ãƒ¼ãƒ—

```bash
# ã‚°ãƒ«ãƒ¼ãƒ—ã®ä½œæˆ
aws xray create-group \
  --group-name "production-errors" \
  --filter-expression 'fault = true AND service("prod-api")'

# ã‚°ãƒ«ãƒ¼ãƒ—ã®ä¸€è¦§
aws xray get-groups

# ã‚°ãƒ«ãƒ¼ãƒ—ã«CloudWatchãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’æœ‰åŠ¹åŒ–
# â†’ ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã®ã‚¨ãƒ©ãƒ¼ç‡ã€ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã‚’ç›£è¦–å¯èƒ½
```

---

## 6. AWS ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆ

### 6.1 çµ±åˆã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§

| ã‚µãƒ¼ãƒ“ã‚¹ | çµ±åˆæ–¹æ³• | è¨­å®š |
|---------|---------|------|
| **Lambda** | ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚° | ã‚³ãƒ³ã‚½ãƒ¼ãƒ« or CLI |
| **API Gateway** | ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°æœ‰åŠ¹åŒ– | ã‚¹ãƒ†ãƒ¼ã‚¸è¨­å®š |
| **ECS/Fargate** | ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠ | ã‚¿ã‚¹ã‚¯å®šç¾© |
| **EC2** | X-Rayãƒ‡ãƒ¼ãƒ¢ãƒ³ | æ‰‹å‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« |
| **ELB** | è‡ªå‹• | ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼è»¢é€ |
| **SNS/SQS** | ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ä¼æ’­ | è‡ªå‹• |
| **Step Functions** | ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚° | ã‚¹ãƒ†ãƒ¼ãƒˆãƒã‚·ãƒ³è¨­å®š |

### 6.2 Lambdaçµ±åˆ

```bash
# Lambdaã§ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°ã‚’æœ‰åŠ¹åŒ–
aws lambda update-function-configuration \
  --function-name my-function \
  --tracing-config Mode=Active

# SAMãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ã®è¨­å®š
# Globals:
#   Function:
#     Tracing: Active
```

### 6.3 API Gatewayçµ±åˆ

```bash
# API Gatewayã§ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°ã‚’æœ‰åŠ¹åŒ–
aws apigateway update-stage \
  --rest-api-id API_ID \
  --stage-name prod \
  --patch-operations op=replace,path=/tracingEnabled,value=true
```

---

## 7. ãƒãƒ³ã‚ºã‚ªãƒ³æ¼”ç¿’

### 7.1 æ¼”ç¿’1: ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã®ç¢ºèª

```bash
# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ç¢ºèª
aws xray get-sampling-rules \
  --query "SamplingRuleRecords[].SamplingRule.{Name:RuleName,Priority:Priority,Rate:FixedRate,Reservoir:ReservoirSize}"

# ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°çµ±è¨ˆã®ç¢ºèª
aws xray get-sampling-statistic-summaries
```

### 7.2 æ¼”ç¿’2: ãƒˆãƒ¬ãƒ¼ã‚¹ã®æ¤œç´¢

```bash
# ç›´è¿‘ã®ãƒˆãƒ¬ãƒ¼ã‚¹ã‚µãƒãƒªãƒ¼å–å¾—
aws xray get-trace-summaries \
  --start-time $(date -u -d '1 hour ago' +%s) \
  --end-time $(date -u +%s) \
  --sampling-strategy '{"Name": "PartialScan", "Value": 0.5}'

# ç‰¹å®šãƒˆãƒ¬ãƒ¼ã‚¹ã®è©³ç´°å–å¾—
aws xray batch-get-traces \
  --trace-ids "1-67a12345-abcdef1234567890abcdef12"

# ã‚µãƒ¼ãƒ“ã‚¹ã‚°ãƒ©ãƒ•ã®å–å¾—
aws xray get-service-graph \
  --start-time $(date -u -d '1 hour ago' +%s) \
  --end-time $(date -u +%s)
```

### 7.3 æ¼”ç¿’3: Lambda + X-Ray

```bash
# Lambdaé–¢æ•°ã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°ã‚’æœ‰åŠ¹åŒ–
FUNCTION_NAME="your-function-name"

aws lambda update-function-configuration \
  --function-name ${FUNCTION_NAME} \
  --tracing-config Mode=Active

# ç¢ºèª
aws lambda get-function-configuration \
  --function-name ${FUNCTION_NAME} \
  --query "TracingConfig"
```

---

## 8. DOPè©¦é¨“å¯¾ç­–ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### åŸºæœ¬ç†è§£

- [ ] ãƒˆãƒ¬ãƒ¼ã‚¹ã€ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã€ã‚µãƒ–ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®é–¢ä¿‚ã‚’èª¬æ˜ã§ãã‚‹
- [ ] Annotationsã¨Metadataã®é•ã„ã¨ä½¿ã„åˆ†ã‘ã‚’çŸ¥ã£ã¦ã„ã‚‹
- [ ] ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã®reservoirã¨rateã‚’ç†è§£ã—ã¦ã„ã‚‹

<details>
<summary>ğŸ“ æ¨¡ç¯„è§£ç­”ã‚’è¦‹ã‚‹</summary>

**ãƒˆãƒ¬ãƒ¼ã‚¹æ§‹é€ **:
- Trace: 1ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å…¨ä½“ï¼ˆTrace IDã§ç´ä»˜ã‘ï¼‰
- Segment: 1ã‚µãƒ¼ãƒ“ã‚¹ã®å‡¦ç†åŒºé–“
- Subsegment: å¤–éƒ¨å‘¼å‡ºã—ï¼ˆAWS SDK, HTTP, SQLï¼‰

**Annotations vs Metadata**:
- Annotations: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚ã‚Šã€æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿å¯èƒ½ã€å‹åˆ¶é™ã‚ã‚Š
- Metadata: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãªã—ã€ä»»æ„ã®JSONã€ãƒ‡ãƒãƒƒã‚°ç”¨

**ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ«**:
- Reservoir: æ¯ç§’ç¢ºå®Ÿã«è¨˜éŒ²ã™ã‚‹æ•°ï¼ˆä¾‹: 1/ç§’ï¼‰
- Rate: ãƒªã‚¶ãƒ¼ãƒè¶…éåˆ†ã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ç‡ï¼ˆä¾‹: 5%ï¼‰
- é«˜ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯æ™‚ã®ã‚³ã‚¹ãƒˆæŠ‘åˆ¶ã«é‡è¦
</details>

### ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆ

- [ ] Lambdaã€API Gatewayã€ECSã§ã®X-Rayæœ‰åŠ¹åŒ–æ–¹æ³•ã‚’çŸ¥ã£ã¦ã„ã‚‹
- [ ] ECSã§ã®ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®Ÿè£…ã§ãã‚‹
- [ ] ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã®ä¼æ’­ã®ä»•çµ„ã¿ã‚’ç†è§£ã—ã¦ã„ã‚‹

<details>
<summary>ğŸ“ æ¨¡ç¯„è§£ç­”ã‚’è¦‹ã‚‹</summary>

**X-Rayæœ‰åŠ¹åŒ–æ–¹æ³•**:
- Lambda: `TracingConfig.Mode=Active`
- API Gateway: ã‚¹ãƒ†ãƒ¼ã‚¸è¨­å®šã§`tracingEnabled=true`
- ECS: X-Rayãƒ‡ãƒ¼ãƒ¢ãƒ³ã‚³ãƒ³ãƒ†ãƒŠã‚’ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã§è¿½åŠ 

**ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³**:
```
ã‚¿ã‚¹ã‚¯å®šç¾©:
  app (ã‚¢ãƒ—ãƒª) â†’ UDP 2000 â†’ xray-daemon â†’ X-Ray API
```

**ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ä¼æ’­**:
- ãƒ˜ãƒƒãƒ€ãƒ¼: `X-Amzn-Trace-Id`
- å½¢å¼: `Root=1-xxx;Parent=xxx;Sampled=1`
- ALB, API GW, SNS, SQSãŒè‡ªå‹•ä¼æ’­
</details>

### åˆ†æãƒ»ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

- [ ] ã‚µãƒ¼ãƒ“ã‚¹ãƒãƒƒãƒ—ã‹ã‚‰ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã‚’ç‰¹å®šã§ãã‚‹
- [ ] ãƒ•ã‚£ãƒ«ã‚¿å¼ã‚’ä½¿ã£ã¦ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’æ¤œç´¢ã§ãã‚‹
- [ ] X-Rayã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆã—ã¦ç‰¹å®šã®ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ç›£è¦–ã§ãã‚‹

<details>
<summary>ğŸ“ æ¨¡ç¯„è§£ç­”ã‚’è¦‹ã‚‹</summary>

**ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ç‰¹å®š**:
1. ã‚µãƒ¼ãƒ“ã‚¹ãƒãƒƒãƒ—ã§ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã®é«˜ã„ãƒãƒ¼ãƒ‰ã‚’ç‰¹å®š
2. ãƒãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“åˆ†å¸ƒã‚’ç¢ºèª
3. ãƒˆãƒ¬ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã§å…·ä½“çš„ãªé…å»¶ç®‡æ‰€ã‚’ç‰¹å®š

**ãƒ•ã‚£ãƒ«ã‚¿å¼**:
```
service("api") AND responsetime > 1
fault = true
annotation.user_id = "user-123"
http.status = 500
```

**X-Rayã‚°ãƒ«ãƒ¼ãƒ—**:
- ãƒ•ã‚£ãƒ«ã‚¿å¼ã«åŸºã¥ããƒˆãƒ¬ãƒ¼ã‚¹ã®ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°
- ã‚°ãƒ«ãƒ¼ãƒ—å˜ä½ã§CloudWatchãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ç™ºè¡Œ
- ã‚¢ãƒ©ãƒ¼ãƒ è¨­å®šã§ç‰¹å®šãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç•°å¸¸ã‚’è‡ªå‹•æ¤œçŸ¥
</details>

---

**ä½œæˆæ—¥**: 2026-02-04
**æœ€çµ‚æ›´æ–°**: 2026-02-04
**æ¤œè¨¼ç’°å¢ƒ**: AWS ap-northeast-1 ãƒªãƒ¼ã‚¸ãƒ§ãƒ³
