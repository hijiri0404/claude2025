# AWS CloudWatch ãƒãƒ³ã‚ºã‚ªãƒ³ã‚¬ã‚¤ãƒ‰

> **å¯¾è±¡**: AWS DevOps Professional (DOP-C02) è©¦é¨“å¯¾ç­–
> **å‰æçŸ¥è­˜**: AWSåŸºç¤ã€LinuxåŸºæœ¬æ“ä½œ
> **æ‰€è¦æ™‚é–“**: ç´„3æ™‚é–“

---

## ç›®æ¬¡

1. [CloudWatchæ¦‚è¦](#1-cloudwatchæ¦‚è¦)
2. [CloudWatch Metrics](#2-cloudwatch-metrics)
3. [CloudWatch Logs](#3-cloudwatch-logs)
4. [CloudWatch Alarms](#4-cloudwatch-alarms)
5. [CloudWatch Events / EventBridge](#5-cloudwatch-events--eventbridge)
6. [CloudWatch Dashboards](#6-cloudwatch-dashboards)
7. [CloudWatch Insights](#7-cloudwatch-insights)
8. [CloudWatch Synthetics](#8-cloudwatch-synthetics)
9. [CloudWatch Container Insights](#9-cloudwatch-container-insights)
10. [ãƒãƒ³ã‚ºã‚ªãƒ³æ¼”ç¿’](#10-ãƒãƒ³ã‚ºã‚ªãƒ³æ¼”ç¿’)
11. [DOPè©¦é¨“å¯¾ç­–ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ](#11-dopè©¦é¨“å¯¾ç­–ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ)

---

## 1. CloudWatchæ¦‚è¦

### 1.1 CloudWatchã¨ã¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Amazon CloudWatch                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ï¼†ã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ“ãƒªãƒ†ã‚£               â”‚â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚â”‚
â”‚  â”‚  â”‚ Metrics  â”‚  â”‚  Logs    â”‚  â”‚  Alarms  â”‚  â”‚ Events   â”‚        â”‚â”‚
â”‚  â”‚  â”‚ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ â”‚  â”‚  ãƒ­ã‚°    â”‚  â”‚ ã‚¢ãƒ©ãƒ¼ãƒ   â”‚  â”‚ ã‚¤ãƒ™ãƒ³ãƒˆ  â”‚        â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚â”‚
â”‚  â”‚  â”‚Dashboard â”‚  â”‚ Insights â”‚  â”‚Syntheticsâ”‚  â”‚Container â”‚        â”‚â”‚
â”‚  â”‚  â”‚ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰â”‚  â”‚ã‚¤ãƒ³ã‚µã‚¤ãƒˆ â”‚  â”‚åˆæˆç›£è¦–   â”‚  â”‚Insights  â”‚        â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                      â”‚
â”‚  ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹: EC2, Lambda, RDS, ECS, EKS, API Gateway, etc.        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | èª¬æ˜ | DOPé‡è¦åº¦ |
|--------------|------|----------|
| **Metrics** | æ•°å€¤ãƒ‡ãƒ¼ã‚¿ã®åé›†ãƒ»ä¿å­˜ | â˜…â˜…â˜…â˜…â˜… |
| **Logs** | ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿ã®åé›†ãƒ»åˆ†æ | â˜…â˜…â˜…â˜…â˜… |
| **Alarms** | ã—ãã„å€¤ãƒ™ãƒ¼ã‚¹ã®é€šçŸ¥ | â˜…â˜…â˜…â˜…â˜… |
| **Events/EventBridge** | ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã®è‡ªå‹•åŒ– | â˜…â˜…â˜…â˜…â˜… |
| **Dashboards** | å¯è¦–åŒ–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | â˜…â˜…â˜…â˜†â˜† |
| **Logs Insights** | ãƒ­ã‚°ã‚¯ã‚¨ãƒªãƒ»åˆ†æ | â˜…â˜…â˜…â˜…â˜† |
| **Synthetics** | å¤–å½¢ç›£è¦–ï¼ˆåˆæˆç›£è¦–ï¼‰ | â˜…â˜…â˜…â˜†â˜† |
| **Container Insights** | ã‚³ãƒ³ãƒ†ãƒŠç›£è¦– | â˜…â˜…â˜…â˜…â˜† |

### 1.3 æ–™é‡‘ä½“ç³»ã®ç†è§£

```
ã€CloudWatchæ–™é‡‘ã®æ§‹æˆè¦ç´ ã€‘

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Metrics                                                      â”‚
â”‚ â”œâ”€ æ¨™æº–ãƒ¡ãƒˆãƒªã‚¯ã‚¹: ç„¡æ–™ï¼ˆAWSæä¾›ï¼‰                            â”‚
â”‚ â”œâ”€ ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹: $0.30/ãƒ¡ãƒˆãƒªã‚¯ã‚¹/æœˆ                    â”‚
â”‚ â””â”€ é«˜è§£åƒåº¦ãƒ¡ãƒˆãƒªã‚¯ã‚¹: è¿½åŠ æ–™é‡‘                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Logs                                                         â”‚
â”‚ â”œâ”€ åé›†: $0.50/GB                                           â”‚
â”‚ â”œâ”€ ä¿å­˜: $0.03/GB/æœˆ                                        â”‚
â”‚ â””â”€ åˆ†æ (Logs Insights): $0.005/GBã‚¹ã‚­ãƒ£ãƒ³                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Alarms                                                       â”‚
â”‚ â”œâ”€ æ¨™æº–ã‚¢ãƒ©ãƒ¼ãƒ : $0.10/ã‚¢ãƒ©ãƒ¼ãƒ /æœˆ                           â”‚
â”‚ â””â”€ é«˜è§£åƒåº¦ã‚¢ãƒ©ãƒ¼ãƒ : $0.30/ã‚¢ãƒ©ãƒ¼ãƒ /æœˆ                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dashboards                                                   â”‚
â”‚ â””â”€ $3.00/ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰/æœˆï¼ˆæœ€åˆã®3ã¤ã¯ç„¡æ–™ï¼‰                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. CloudWatch Metrics

### 2.1 ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®åŸºæœ¬æ¦‚å¿µ

```
ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®æ§‹é€ ã€‘

Namespaceï¼ˆåå‰ç©ºé–“ï¼‰
  â””â”€ Dimensionï¼ˆãƒ‡ã‚£ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ï¼‰
       â””â”€ Metric Nameï¼ˆãƒ¡ãƒˆãƒªã‚¯ã‚¹åï¼‰
            â””â”€ Data Pointsï¼ˆãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆï¼‰
                 â”œâ”€ Timestamp
                 â”œâ”€ Value
                 â””â”€ Unit

ä¾‹: AWS/EC2 > InstanceId=i-1234567890abcdef0 > CPUUtilization
```

### 2.2 æ¨™æº–ãƒ¡ãƒˆãƒªã‚¯ã‚¹ vs ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹

| é …ç›® | æ¨™æº–ãƒ¡ãƒˆãƒªã‚¯ã‚¹ | ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ |
|-----|--------------|------------------|
| **å–å¾—æ–¹æ³•** | AWSè‡ªå‹•åé›† | API/AgentçµŒç”±ã§é€ä¿¡ |
| **è§£åƒåº¦** | 1åˆ† or 5åˆ† | 1ç§’ã€œï¼ˆé«˜è§£åƒåº¦ï¼‰ |
| **ä¿æŒæœŸé–“** | 15ãƒ¶æœˆ | 15ãƒ¶æœˆ |
| **æ–™é‡‘** | ç„¡æ–™ | æœ‰æ–™ |
| **ä¾‹** | CPUä½¿ç”¨ç‡ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯I/O | ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ã€ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨ç‡ |

### 2.3 ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®é€ä¿¡

```bash
# AWS CLIã§ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’é€ä¿¡
aws cloudwatch put-metric-data \
  --namespace "MyApplication" \
  --metric-name "RequestCount" \
  --value 100 \
  --unit "Count" \
  --dimensions "Environment=Production,Service=API"

# é«˜è§£åƒåº¦ãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼ˆ1ç§’é–“éš”ï¼‰
aws cloudwatch put-metric-data \
  --namespace "MyApplication" \
  --metric-name "HighResolutionMetric" \
  --value 42 \
  --storage-resolution 1
```

### 2.4 CloudWatch Agent

```
ã€CloudWatch Agent ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€‘

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       EC2 Instance                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚               CloudWatch Agent                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚   Metrics   â”‚  â”‚    Logs     â”‚  â”‚   StatsD    â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  Collector  â”‚  â”‚  Collector  â”‚  â”‚  Collector  â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚         â”‚                â”‚                â”‚           â”‚ â”‚
â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â”‚
â”‚  â”‚                          â”‚                            â”‚ â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                      â”‚ â”‚
â”‚  â”‚                    â”‚  Buffer   â”‚                      â”‚ â”‚
â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   CloudWatch    â”‚
                    â”‚  Metrics/Logs   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Agentè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä¾‹

```json
{
  "agent": {
    "metrics_collection_interval": 60,
    "run_as_user": "cwagent"
  },
  "metrics": {
    "namespace": "MyCustomNamespace",
    "metrics_collected": {
      "mem": {
        "measurement": ["mem_used_percent"]
      },
      "disk": {
        "measurement": ["disk_used_percent"],
        "resources": ["/", "/data"]
      }
    }
  },
  "logs": {
    "logs_collected": {
      "files": {
        "collect_list": [
          {
            "file_path": "/var/log/messages",
            "log_group_name": "/ec2/messages",
            "log_stream_name": "{instance_id}"
          }
        ]
      }
    }
  }
}
```

### 2.5 ãƒ¡ãƒˆãƒªã‚¯ã‚¹çµ±è¨ˆã¨æœŸé–“

| çµ±è¨ˆ | èª¬æ˜ | ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ |
|-----|------|-------------|
| **Average** | å¹³å‡å€¤ | CPUä½¿ç”¨ç‡ã®å‚¾å‘åˆ†æ |
| **Sum** | åˆè¨ˆå€¤ | ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã®ã‚«ã‚¦ãƒ³ãƒˆ |
| **Minimum** | æœ€å°å€¤ | ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã®æœ€è‰¯ã‚±ãƒ¼ã‚¹ |
| **Maximum** | æœ€å¤§å€¤ | ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã®ãƒ”ãƒ¼ã‚¯æ¤œå‡º |
| **SampleCount** | ã‚µãƒ³ãƒ—ãƒ«æ•° | ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆæ•°ã®ç¢ºèª |
| **pNN** | ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ« | p99ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ï¼ˆ99%ã‚¿ã‚¤ãƒ«ï¼‰ |

---

## 3. CloudWatch Logs

### 3.1 ãƒ­ã‚°ã®åŸºæœ¬æ§‹é€ 

```
ã€CloudWatch Logs éšå±¤æ§‹é€ ã€‘

Log Groupï¼ˆãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ï¼‰
  â”œâ”€ /aws/lambda/my-function
  â”œâ”€ /aws/ecs/my-cluster
  â””â”€ /application/my-app
       â”‚
       â””â”€ Log Streamï¼ˆãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ ï¼‰
            â”œâ”€ instance-1
            â”œâ”€ instance-2
            â””â”€ instance-3
                 â”‚
                 â””â”€ Log Eventsï¼ˆãƒ­ã‚°ã‚¤ãƒ™ãƒ³ãƒˆï¼‰
                      â”œâ”€ timestamp: 1704067200000
                      â”‚  message: "INFO: Request received"
                      â”œâ”€ timestamp: 1704067201000
                      â”‚  message: "INFO: Processing..."
                      â””â”€ timestamp: 1704067202000
                         message: "INFO: Response sent"
```

### 3.2 ãƒ­ã‚°ä¿æŒæœŸé–“ã®è¨­å®š

```bash
# ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ã®ä¿æŒæœŸé–“ã‚’è¨­å®šï¼ˆ30æ—¥ï¼‰
aws logs put-retention-policy \
  --log-group-name "/aws/lambda/my-function" \
  --retention-in-days 30

# ä¿æŒæœŸé–“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³
# 1, 3, 5, 7, 14, 30, 60, 90, 120, 150, 180, 365, 400, 545, 731, 1827, 3653
# ã¾ãŸã¯ç„¡æœŸé™ï¼ˆè¨­å®šãªã—ï¼‰
```

### 3.3 ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼

```
ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®ä»•çµ„ã¿ã€‘

CloudWatch Logs                    CloudWatch Metrics
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Log Group    â”‚                â”‚   Namespace    â”‚
â”‚                â”‚  â”€â”€ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼â”€â”€â–¶ â”‚                â”‚
â”‚ ERROR occurred â”‚   ãƒ‘ã‚¿ãƒ¼ãƒ³     â”‚ ErrorCount: 1  â”‚
â”‚ ERROR occurred â”‚   "ERROR"      â”‚ ErrorCount: 2  â”‚
â”‚ INFO success   â”‚                â”‚                â”‚
â”‚ ERROR timeout  â”‚                â”‚ ErrorCount: 3  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```bash
# ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®ä½œæˆ
aws logs put-metric-filter \
  --log-group-name "/aws/lambda/my-function" \
  --filter-name "ErrorFilter" \
  --filter-pattern "ERROR" \
  --metric-transformations \
    metricName=ErrorCount,metricNamespace=MyApp,metricValue=1
```

### 3.4 ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼

```
ã€ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‘

CloudWatch Logs
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Subscription Filter                          â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Kinesis    â”‚  â”‚   Lambda     â”‚  â”‚  Firehose    â”‚  â”‚
â”‚  â”‚   Streams    â”‚  â”‚  Function    â”‚  â”‚   Delivery   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                  â”‚                  â”‚
          â–¼                  â–¼                  â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  åˆ†æ    â”‚      â”‚  å¤‰æ›    â”‚      â”‚   S3     â”‚
    â”‚ OpenSearchâ”‚      â”‚  å‡¦ç†    â”‚      â”‚ é•·æœŸä¿å­˜ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```bash
# Lambdaé–¢æ•°ã¸ã®ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
aws logs put-subscription-filter \
  --log-group-name "/aws/lambda/my-function" \
  --filter-name "LambdaProcessor" \
  --filter-pattern "ERROR" \
  --destination-arn "arn:aws:lambda:ap-northeast-1:123456789012:function:log-processor"
```

### 3.5 ã‚¯ãƒ­ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ã‚°å…±æœ‰

```
ã€ã‚¯ãƒ­ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ã‚°é›†ç´„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€‘

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Account A     â”‚  â”‚   Account B     â”‚  â”‚   Account C     â”‚
â”‚   (Dev)         â”‚  â”‚   (Staging)     â”‚  â”‚   (Prod)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Logs    â”‚  â”‚  â”‚  â”‚   Logs    â”‚  â”‚  â”‚  â”‚   Logs    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚                    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ Subscription Filter
                        â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Central Log    â”‚
              â”‚  Account        â”‚
              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
              â”‚  â”‚ Kinesis   â”‚  â”‚
              â”‚  â”‚ Firehose  â”‚  â”‚
              â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
              â”‚        â–¼        â”‚
              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
              â”‚  â”‚    S3     â”‚  â”‚
              â”‚  â”‚ (Archive) â”‚  â”‚
              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. CloudWatch Alarms

### 4.1 ã‚¢ãƒ©ãƒ¼ãƒ ã®çŠ¶æ…‹

```
ã€ã‚¢ãƒ©ãƒ¼ãƒ çŠ¶æ…‹é·ç§»ã€‘

                    ã—ãã„å€¤è¶…é
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                 â–¼
   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   OK    â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  ALARM   â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    ã—ãã„å€¤å†…ã«å¾©å¸°   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                 â–²
        â”‚         ãƒ‡ãƒ¼ã‚¿ä¸è¶³              â”‚
        â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
        â–¼    â–¼                            â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     ãƒ‡ãƒ¼ã‚¿å¾©å¸°         â”‚
   â”‚INSUFFICIENT â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚    DATA     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ã‚¢ãƒ©ãƒ¼ãƒ è¨­å®šã®é‡è¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | èª¬æ˜ | ä¾‹ |
|----------|------|-----|
| **Period** | è©•ä¾¡é–“éš” | 60ç§’ã€300ç§’ |
| **EvaluationPeriods** | è©•ä¾¡æœŸé–“æ•° | 3 |
| **DatapointsToAlarm** | ã‚¢ãƒ©ãƒ¼ãƒ ç™ºç«ã«å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆæ•° | 2 |
| **Threshold** | ã—ãã„å€¤ | 80 |
| **ComparisonOperator** | æ¯”è¼ƒæ¼”ç®—å­ | GreaterThanThreshold |
| **TreatMissingData** | æ¬ æãƒ‡ãƒ¼ã‚¿ã®æ‰±ã„ | missing, notBreaching, breaching, ignore |

### 4.3 ã‚¢ãƒ©ãƒ¼ãƒ ã®ä½œæˆ

```bash
# CPUä½¿ç”¨ç‡ã®ã‚¢ãƒ©ãƒ¼ãƒ ä½œæˆ
aws cloudwatch put-metric-alarm \
  --alarm-name "HighCPUAlarm" \
  --alarm-description "CPUä½¿ç”¨ç‡ãŒ80%ã‚’è¶…ãˆãŸå ´åˆã«ã‚¢ãƒ©ãƒ¼ãƒˆ" \
  --metric-name "CPUUtilization" \
  --namespace "AWS/EC2" \
  --statistic "Average" \
  --period 300 \
  --threshold 80 \
  --comparison-operator "GreaterThanThreshold" \
  --evaluation-periods 3 \
  --datapoints-to-alarm 2 \
  --dimensions "Name=InstanceId,Value=i-1234567890abcdef0" \
  --alarm-actions "arn:aws:sns:ap-northeast-1:123456789012:my-topic" \
  --ok-actions "arn:aws:sns:ap-northeast-1:123456789012:my-topic" \
  --treat-missing-data "missing"
```

### 4.4 è¤‡åˆã‚¢ãƒ©ãƒ¼ãƒ ï¼ˆComposite Alarmï¼‰

```
ã€è¤‡åˆã‚¢ãƒ©ãƒ¼ãƒ ã®æ§‹æˆã€‘

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Composite Alarm                          â”‚
â”‚                  "ServiceHealthAlarm"                      â”‚
â”‚                                                            â”‚
â”‚    Rule: ALARM(CPUAlarm) AND ALARM(MemoryAlarm)           â”‚
â”‚                                                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚    â”‚   CPUAlarm     â”‚  AND   â”‚  MemoryAlarm   â”‚          â”‚
â”‚    â”‚   (ALARM)      â”‚        â”‚   (ALARM)      â”‚          â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                            â”‚
â”‚    â†’ ä¸¡æ–¹ALARMã®æ™‚ã®ã¿é€šçŸ¥                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```bash
# è¤‡åˆã‚¢ãƒ©ãƒ¼ãƒ ã®ä½œæˆ
aws cloudwatch put-composite-alarm \
  --alarm-name "ServiceHealthAlarm" \
  --alarm-rule "ALARM(CPUAlarm) AND ALARM(MemoryAlarm)" \
  --alarm-actions "arn:aws:sns:ap-northeast-1:123456789012:critical-alerts"
```

### 4.5 ã‚¢ãƒ©ãƒ¼ãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

```
ã€ã‚¢ãƒ©ãƒ¼ãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ç¨®é¡ã€‘

CloudWatch Alarm
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Alarm Actions                           â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚     SNS      â”‚  â”‚Auto Scaling  â”‚  â”‚    EC2       â”‚  â”‚
â”‚  â”‚   é€šçŸ¥é€ä¿¡   â”‚  â”‚ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°  â”‚  â”‚  åœæ­¢/çµ‚äº†   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Lambda     â”‚  â”‚Systems Mgr   â”‚  â”‚  EventBridge â”‚  â”‚
â”‚  â”‚  é–¢æ•°å®Ÿè¡Œ    â”‚  â”‚ Automation   â”‚  â”‚  ã‚¤ãƒ™ãƒ³ãƒˆ    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. CloudWatch Events / EventBridge

### 5.1 EventBridgeã®åŸºæœ¬æ¦‚å¿µ

```
ã€EventBridge ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€‘

ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹              Event Bus             ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AWS Servicesâ”‚ â”€â”€â”€â”€â”€â”€â”€â–¶â”‚              â”‚      â”‚   Lambda    â”‚
â”‚ (EC2, S3...)â”‚         â”‚              â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚              â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚    Rules     â”‚â”€â”€â”€â”€â”€â–¶â”‚Step Functionsâ”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   (ãƒ«ãƒ¼ãƒ«)   â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  SaaS Apps  â”‚ â”€â”€â”€â”€â”€â”€â”€â–¶â”‚              â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚(Datadogç­‰)  â”‚         â”‚              â”‚â”€â”€â”€â”€â”€â–¶â”‚    SNS      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚              â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚              â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚              â”‚â”€â”€â”€â”€â”€â–¶â”‚    SQS      â”‚
â”‚ Custom Apps â”‚ â”€â”€â”€â”€â”€â”€â”€â–¶â”‚              â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ (APIçµŒç”±)   â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ã‚¤ãƒ™ãƒ³ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³

```json
// EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹çŠ¶æ…‹å¤‰æ›´ã‚¤ãƒ™ãƒ³ãƒˆ
{
  "source": ["aws.ec2"],
  "detail-type": ["EC2 Instance State-change Notification"],
  "detail": {
    "state": ["stopped", "terminated"]
  }
}

// CodePipelineã‚¹ãƒ†ãƒ¼ã‚¸å¤‰æ›´ã‚¤ãƒ™ãƒ³ãƒˆ
{
  "source": ["aws.codepipeline"],
  "detail-type": ["CodePipeline Stage Execution State Change"],
  "detail": {
    "state": ["FAILED"]
  }
}

// S3ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä½œæˆã‚¤ãƒ™ãƒ³ãƒˆ
{
  "source": ["aws.s3"],
  "detail-type": ["Object Created"],
  "detail": {
    "bucket": {
      "name": ["my-bucket"]
    },
    "object": {
      "key": [{"prefix": "uploads/"}]
    }
  }
}
```

### 5.3 ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å¼

```bash
# cronå¼ï¼ˆæ¯æ—¥åˆå‰9æ™‚ã«å®Ÿè¡Œï¼‰
aws events put-rule \
  --name "DailyBackup" \
  --schedule-expression "cron(0 9 * * ? *)"

# rateå¼ï¼ˆ5åˆ†ã”ã¨ã«å®Ÿè¡Œï¼‰
aws events put-rule \
  --name "HealthCheck" \
  --schedule-expression "rate(5 minutes)"
```

| cronå¼ | èª¬æ˜ |
|--------|------|
| `cron(0 9 * * ? *)` | æ¯æ—¥9:00 UTC |
| `cron(0 18 ? * MON-FRI *)` | å¹³æ—¥18:00 UTC |
| `cron(0/15 * * * ? *)` | 15åˆ†ã”ã¨ |

### 5.4 EventBridgeãƒ«ãƒ¼ãƒ«ã®ä½œæˆ

```bash
# ãƒ«ãƒ¼ãƒ«ã®ä½œæˆ
aws events put-rule \
  --name "EC2StateChangeRule" \
  --event-pattern '{
    "source": ["aws.ec2"],
    "detail-type": ["EC2 Instance State-change Notification"],
    "detail": {
      "state": ["stopped"]
    }
  }' \
  --state ENABLED

# ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®è¿½åŠ 
aws events put-targets \
  --rule "EC2StateChangeRule" \
  --targets '[
    {
      "Id": "1",
      "Arn": "arn:aws:sns:ap-northeast-1:123456789012:ec2-alerts"
    }
  ]'
```

---

## 6. CloudWatch Dashboards

### 6.1 ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®æ§‹æˆ

```
ã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€‘

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Production Dashboard                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   CPU Utilization        â”‚    Memory Utilization            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚    /\  /\      â”‚     â”‚    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚           â”‚
â”‚   â”‚   /  \/  \     â”‚     â”‚    â”‚      \_____    â”‚           â”‚
â”‚   â”‚  /        \    â”‚     â”‚    â”‚              \ â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Request Count          â”‚    Error Rate                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ  â”‚     â”‚    â”‚  0.5%          â”‚           â”‚
â”‚   â”‚ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ  â”‚     â”‚    â”‚                â”‚           â”‚
â”‚   â”‚ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ  â”‚     â”‚    â”‚                â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Active Alarms                             â”‚
â”‚   [OK] CPU Alarm    [ALARM] Memory Alarm    [OK] Disk Alarm â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰å®šç¾©ï¼ˆJSONï¼‰

```json
{
  "widgets": [
    {
      "type": "metric",
      "x": 0, "y": 0,
      "width": 12, "height": 6,
      "properties": {
        "title": "EC2 CPU Utilization",
        "metrics": [
          ["AWS/EC2", "CPUUtilization", "InstanceId", "i-1234567890abcdef0"]
        ],
        "period": 300,
        "stat": "Average",
        "region": "ap-northeast-1"
      }
    },
    {
      "type": "alarm",
      "x": 0, "y": 6,
      "width": 24, "height": 3,
      "properties": {
        "title": "Active Alarms",
        "alarms": [
          "arn:aws:cloudwatch:ap-northeast-1:123456789012:alarm:CPUAlarm",
          "arn:aws:cloudwatch:ap-northeast-1:123456789012:alarm:MemoryAlarm"
        ]
      }
    },
    {
      "type": "log",
      "x": 12, "y": 0,
      "width": 12, "height": 6,
      "properties": {
        "title": "Application Errors",
        "query": "SOURCE '/aws/lambda/my-function' | filter @message like /ERROR/ | stats count() by bin(5m)",
        "region": "ap-northeast-1"
      }
    }
  ]
}
```

### 6.3 ã‚¯ãƒ­ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ»ã‚¯ãƒ­ã‚¹ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

```
ã€ã‚¯ãƒ­ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã€‘

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Monitoring Account                          â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚              Cross-Account Dashboard                     â”‚â”‚
â”‚  â”‚                                                          â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚â”‚
â”‚  â”‚  â”‚ Account Aâ”‚  â”‚ Account Bâ”‚  â”‚ Account Câ”‚             â”‚â”‚
â”‚  â”‚  â”‚ us-east-1â”‚  â”‚ eu-west-1â”‚  â”‚ap-northeast-1â”‚          â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜             â”‚â”‚
â”‚  â”‚       â”‚             â”‚             â”‚                    â”‚â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚â”‚
â”‚  â”‚                     â”‚                                   â”‚â”‚
â”‚  â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚â”‚
â”‚  â”‚            â”‚ Unified View    â”‚                         â”‚â”‚
â”‚  â”‚            â”‚ (çµ±åˆãƒ“ãƒ¥ãƒ¼)     â”‚                         â”‚â”‚
â”‚  â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. CloudWatch Insights

### 7.1 Logs Insights ã‚¯ã‚¨ãƒªæ§‹æ–‡

```sql
-- åŸºæœ¬çš„ãªãƒ­ã‚°æ¤œç´¢
fields @timestamp, @message
| filter @message like /ERROR/
| sort @timestamp desc
| limit 100

-- ã‚¨ãƒ©ãƒ¼ã‚«ã‚¦ãƒ³ãƒˆï¼ˆ5åˆ†é–“éš”ï¼‰
fields @timestamp, @message
| filter @message like /ERROR/
| stats count() as ErrorCount by bin(5m)

-- ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·åˆ†æ
fields @timestamp, @duration
| stats avg(@duration) as AvgDuration,
        max(@duration) as MaxDuration,
        pct(@duration, 99) as p99Duration
  by bin(5m)

-- Lambdaé–¢æ•°ã®ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆæ¤œå‡º
fields @timestamp, @message, @duration
| filter @type = "REPORT"
| filter @message like /Init Duration/
| parse @message "Init Duration: * ms" as initDuration
| stats count() as ColdStarts, avg(initDuration) as AvgInitMs by bin(1h)

-- ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ
fields @timestamp, @message
| filter @message like /Exception/
| parse @message "*.Exception: *" as exceptionType, errorMessage
| stats count() by exceptionType
| sort count desc
```

### 7.2 Container Insights ã‚¯ã‚¨ãƒª

```sql
-- Pod CPUä½¿ç”¨ç‡
fields @timestamp, PodName, CpuUtilized
| filter Type = "Pod"
| stats avg(CpuUtilized) as AvgCpu by PodName

-- ã‚³ãƒ³ãƒ†ãƒŠãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
fields @timestamp, ContainerName, MemoryUtilized
| filter Type = "Container"
| stats max(MemoryUtilized) as MaxMemory by ContainerName
| sort MaxMemory desc

-- ãƒãƒ¼ãƒ‰åˆ¥ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨ç‡
fields @timestamp, NodeName, node_cpu_utilization, node_memory_utilization
| filter Type = "Node"
| stats avg(node_cpu_utilization) as AvgCPU,
        avg(node_memory_utilization) as AvgMemory
  by NodeName
```

### 7.3 Metrics Insights

```sql
-- EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å…¨ä½“ã®CPUä½¿ç”¨ç‡
SELECT AVG(CPUUtilization)
FROM SCHEMA("AWS/EC2", InstanceId)
GROUP BY InstanceId
ORDER BY AVG() DESC
LIMIT 10

-- Lambdaé–¢æ•°ã®ã‚¨ãƒ©ãƒ¼ç‡
SELECT SUM(Errors) / SUM(Invocations) * 100 as ErrorRate
FROM SCHEMA("AWS/Lambda", FunctionName)
GROUP BY FunctionName
HAVING SUM(Invocations) > 100
ORDER BY ErrorRate DESC
```

---

## 8. CloudWatch Synthetics

### 8.1 Syntheticsã®æ¦‚è¦

```
ã€CloudWatch Synthetics ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€‘

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 CloudWatch Synthetics                        â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    Canary                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚ â”‚
â”‚  â”‚  â”‚   Lambda    â”‚ â”€â”€â”€â”€â”€â–¶ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ                 â”‚ â”‚
â”‚  â”‚  â”‚  (Node.js/  â”‚        ç›£è¦–å¯¾è±¡                      â”‚ â”‚
â”‚  â”‚  â”‚   Python)   â”‚                                      â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                      â”‚ â”‚
â”‚  â”‚         â”‚                                              â”‚ â”‚
â”‚  â”‚         â–¼                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚ å‡ºåŠ›                                            â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€ HAR (HTTP Archive) ãƒ•ã‚¡ã‚¤ãƒ«                  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€ ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ                           â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€ ãƒ­ã‚°                                         â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ (SuccessPercent, Duration)        â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 Canary ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¾‹

```javascript
// APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆç›£è¦–
const synthetics = require('Synthetics');
const log = require('SyntheticsLogger');

const apiCanaryBlueprint = async function () {
  const requestOptions = {
    hostname: 'api.example.com',
    method: 'GET',
    path: '/health',
    port: 443,
    protocol: 'https:'
  };

  // ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
  let stepConfig = {
    includeRequestHeaders: true,
    includeResponseHeaders: true,
    includeRequestBody: true,
    includeResponseBody: true
  };

  await synthetics.executeHttpStep('healthCheck', requestOptions, null, stepConfig);
  log.info('Health check passed');
};

exports.handler = async () => {
  return await apiCanaryBlueprint();
};
```

```python
# Webãƒšãƒ¼ã‚¸ç›£è¦–ï¼ˆPythonï¼‰
from aws_synthetics.selenium import synthetics_webdriver as syn_webdriver
from aws_synthetics.common import synthetics_logger as logger

def main():
    url = "https://www.example.com"

    browser = syn_webdriver.Chrome()
    browser.get(url)

    # ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«æ¤œè¨¼
    title = browser.title
    logger.info(f"Page title: {title}")

    if "Example" not in title:
        raise Exception(f"Unexpected title: {title}")

    # ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆå–å¾—
    browser.save_screenshot("loaded.png")

    browser.quit()

def handler(event, context):
    return main()
```

### 8.3 Canaryã®ä½œæˆ

```bash
# Canaryã®ä½œæˆ
aws synthetics create-canary \
  --name "api-health-check" \
  --artifact-s3-location "s3://my-canary-artifacts/api-health-check" \
  --execution-role-arn "arn:aws:iam::123456789012:role/canary-role" \
  --schedule "Expression=rate(5 minutes)" \
  --runtime-version "syn-nodejs-puppeteer-6.2" \
  --code "Handler=apiCanary.handler,S3Bucket=my-canary-code,S3Key=canary.zip"

# Canaryã®é–‹å§‹
aws synthetics start-canary --name "api-health-check"
```

---

## 9. CloudWatch Container Insights

### 9.1 Container Insightsã®æœ‰åŠ¹åŒ–

```bash
# ECSã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã§Container Insightsã‚’æœ‰åŠ¹åŒ–
aws ecs update-cluster-settings \
  --cluster my-cluster \
  --settings name=containerInsights,value=enabled

# EKSã§Container Insightsã‚’æœ‰åŠ¹åŒ–ï¼ˆCloudWatch Agent DaemonSetï¼‰
kubectl apply -f https://raw.githubusercontent.com/aws-samples/amazon-cloudwatch-container-insights/latest/k8s-deployment-manifest-templates/deployment-mode/daemonset/container-insights-monitoring/quickstart/cwagent-fluentd-quickstart.yaml
```

### 9.2 åé›†ã•ã‚Œã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹

```
ã€Container Insightsãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€‘

ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ¬ãƒ™ãƒ«
â”œâ”€ cluster_cpu_utilization
â”œâ”€ cluster_memory_utilization
â”œâ”€ cluster_node_count
â””â”€ cluster_failed_node_count

ã‚µãƒ¼ãƒ“ã‚¹ãƒ¬ãƒ™ãƒ«
â”œâ”€ service_cpu_utilization
â”œâ”€ service_memory_utilization
â”œâ”€ service_running_task_count
â””â”€ service_pending_task_count

ã‚¿ã‚¹ã‚¯/Podãƒ¬ãƒ™ãƒ«
â”œâ”€ pod_cpu_utilization / task_cpu_utilization
â”œâ”€ pod_memory_utilization / task_memory_utilization
â”œâ”€ pod_network_rx_bytes / task_network_rx_bytes
â””â”€ pod_network_tx_bytes / task_network_tx_bytes

ã‚³ãƒ³ãƒ†ãƒŠãƒ¬ãƒ™ãƒ«
â”œâ”€ container_cpu_utilization
â”œâ”€ container_memory_utilization
â””â”€ container_restart_count
```

### 9.3 Performance Logã®æ´»ç”¨

```sql
-- EKS: Podåˆ¥ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨ç‡
fields @timestamp, PodName, pod_cpu_utilization, pod_memory_utilization
| filter Type = "Pod"
| filter Namespace = "default"
| stats avg(pod_cpu_utilization) as CPU, avg(pod_memory_utilization) as Memory by PodName

-- ECS: ã‚¿ã‚¹ã‚¯åˆ¥ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
fields @timestamp, TaskId, MemoryUtilized, MemoryReserved
| filter Type = "Task"
| stats avg(MemoryUtilized) as AvgUsed, max(MemoryReserved) as Reserved by TaskId
| sort AvgUsed desc
```

---

## 10. ãƒãƒ³ã‚ºã‚ªãƒ³æ¼”ç¿’

### 10.1 æ¼”ç¿’1: ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨ã‚¢ãƒ©ãƒ¼ãƒ 

```bash
# 1. ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’é€ä¿¡
aws cloudwatch put-metric-data \
  --namespace "HandsOn/Application" \
  --metric-name "ActiveUsers" \
  --value 150 \
  --unit "Count"

# ç¢ºèª
aws cloudwatch get-metric-statistics \
  --namespace "HandsOn/Application" \
  --metric-name "ActiveUsers" \
  --start-time $(date -u -d '10 minutes ago' +%Y-%m-%dT%H:%M:%SZ) \
  --end-time $(date -u +%Y-%m-%dT%H:%M:%SZ) \
  --period 60 \
  --statistics Average
```

**å®Ÿè¡Œçµæœ**:
```json
{
    "Label": "ActiveUsers",
    "Datapoints": [
        {
            "Timestamp": "2026-02-03T14:45:00+00:00",
            "Average": 150.0,
            "Unit": "Count"
        }
    ]
}
```
âœ… **æ¤œè¨¼æ¸ˆã¿** (2026-02-03)

### 10.2 æ¼”ç¿’2: ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ã¨ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼

```bash
# 1. ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ
aws logs create-log-group --log-group-name "/handson/application"

# 2. ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ ä½œæˆ
aws logs create-log-stream \
  --log-group-name "/handson/application" \
  --log-stream-name "app-server-1"

# 3. ãƒ­ã‚°ã‚¤ãƒ™ãƒ³ãƒˆé€ä¿¡
aws logs put-log-events \
  --log-group-name "/handson/application" \
  --log-stream-name "app-server-1" \
  --log-events \
    timestamp=$(date +%s000),message="INFO: Application started" \
    timestamp=$(date +%s001),message="ERROR: Database connection failed" \
    timestamp=$(date +%s002),message="INFO: Retrying connection" \
    timestamp=$(date +%s003),message="ERROR: Timeout occurred"

# 4. ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ä½œæˆ
aws logs put-metric-filter \
  --log-group-name "/handson/application" \
  --filter-name "ErrorCountFilter" \
  --filter-pattern "ERROR" \
  --metric-transformations \
    metricName=ErrorCount,metricNamespace=HandsOn/Application,metricValue=1

# 5. ç¢ºèª
aws logs describe-metric-filters \
  --log-group-name "/handson/application"
```

**å®Ÿè¡Œçµæœ**:
```json
{
    "metricFilters": [
        {
            "filterName": "ErrorCountFilter",
            "filterPattern": "ERROR",
            "metricTransformations": [
                {
                    "metricName": "ErrorCount",
                    "metricNamespace": "HandsOn/Application",
                    "metricValue": "1"
                }
            ],
            "creationTime": 1738593920000,
            "logGroupName": "/handson/application"
        }
    ]
}
```
âœ… **æ¤œè¨¼æ¸ˆã¿** (2026-02-03)

### 10.3 æ¼”ç¿’3: Logs Insightsã‚¯ã‚¨ãƒª

```bash
# Logs Insightsã‚¯ã‚¨ãƒªã®å®Ÿè¡Œ
aws logs start-query \
  --log-group-name "/handson/application" \
  --start-time $(date -u -d '1 hour ago' +%s) \
  --end-time $(date -u +%s) \
  --query-string 'fields @timestamp, @message | filter @message like /ERROR/ | stats count() as ErrorCount'

# ã‚¯ã‚¨ãƒªçµæœã®å–å¾—ï¼ˆquery-idã‚’ä½¿ç”¨ï¼‰
aws logs get-query-results --query-id "QUERY_ID"
```

### 10.4 æ¼”ç¿’4: EventBridgeãƒ«ãƒ¼ãƒ«

```bash
# 1. SNSãƒˆãƒ”ãƒƒã‚¯ä½œæˆ
aws sns create-topic --name handson-alerts
# â†’ TopicArn: arn:aws:sns:ap-northeast-1:471112657080:handson-alerts

# 2. EventBridgeãƒ«ãƒ¼ãƒ«ä½œæˆï¼ˆEC2çŠ¶æ…‹å¤‰æ›´ï¼‰
aws events put-rule \
  --name "HandsOnEC2StateChange" \
  --event-pattern '{
    "source": ["aws.ec2"],
    "detail-type": ["EC2 Instance State-change Notification"]
  }' \
  --state ENABLED

# 3. ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¿½åŠ 
aws events put-targets \
  --rule "HandsOnEC2StateChange" \
  --targets "Id"="1","Arn"="arn:aws:sns:ap-northeast-1:471112657080:handson-alerts"

# 4. ç¢ºèª
aws events describe-rule --name "HandsOnEC2StateChange"
```

**å®Ÿè¡Œçµæœ**:
```json
{
    "Name": "HandsOnEC2StateChange",
    "Arn": "arn:aws:events:ap-northeast-1:471112657080:rule/HandsOnEC2StateChange",
    "EventPattern": "{\"source\":[\"aws.ec2\"],\"detail-type\":[\"EC2 Instance State-change Notification\"]}",
    "State": "ENABLED",
    "EventBusName": "default"
}
```
âœ… **æ¤œè¨¼æ¸ˆã¿** (2026-02-03)

### 10.5 ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

```bash
# ãƒªã‚½ãƒ¼ã‚¹ã®å‰Šé™¤
aws logs delete-log-group --log-group-name "/handson/application"
aws cloudwatch delete-alarms --alarm-names "HighCPUAlarm"
aws events remove-targets --rule "HandsOnEC2StateChange" --ids "1"
aws events delete-rule --name "HandsOnEC2StateChange"
aws sns delete-topic --topic-arn "arn:aws:sns:ap-northeast-1:471112657080:handson-alerts"
```

---

## 11. DOPè©¦é¨“å¯¾ç­–ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### åŸºæœ¬ç†è§£

- [ ] CloudWatchã®5ã¤ã®ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’èª¬æ˜ã§ãã‚‹
- [ ] æ¨™æº–ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®é•ã„ã‚’ç†è§£ã—ã¦ã„ã‚‹
- [ ] CloudWatch Agentã®å½¹å‰²ã¨è¨­å®šæ–¹æ³•ã‚’çŸ¥ã£ã¦ã„ã‚‹

<details>
<summary>ğŸ“ æ¨¡ç¯„è§£ç­”ã‚’è¦‹ã‚‹</summary>

**CloudWatchã®5ã¤ã®ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**:
1. **Metrics**: CPUä½¿ç”¨ç‡ã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€šä¿¡é‡ãªã©ã®æ•°å€¤ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ãƒ»ä¿å­˜
2. **Logs**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°ã‚„ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°ã‚’åé›†ãƒ»åˆ†æ
3. **Alarms**: ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ã—ãã„å€¤ç›£è¦–ã¨è‡ªå‹•ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
4. **Events/EventBridge**: AWSã‚µãƒ¼ãƒ“ã‚¹é–“ã®ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å‹ã®è‡ªå‹•åŒ–
5. **Dashboards**: ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨ãƒ­ã‚°ã®å¯è¦–åŒ–

**æ¨™æº–ãƒ¡ãƒˆãƒªã‚¯ã‚¹ vs ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹**:
- æ¨™æº–: AWSãŒè‡ªå‹•åé›†ï¼ˆCPUã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç­‰ï¼‰ã€ç„¡æ–™ã€1-5åˆ†é–“éš”
- ã‚«ã‚¹ã‚¿ãƒ : ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé€ä¿¡ï¼ˆãƒ¡ãƒ¢ãƒªã€ã‚¢ãƒ—ãƒªå›ºæœ‰ç­‰ï¼‰ã€æœ‰æ–™ã€1ç§’ã€œ

**CloudWatch Agent**:
- EC2ã‚„ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨ãƒ­ã‚°ã‚’åé›†
- JSONè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§åé›†å¯¾è±¡ã‚’å®šç¾©
- Systems Manager Parameter Storeã§è¨­å®šã‚’ä¸€å…ƒç®¡ç†å¯èƒ½
</details>

### ãƒ­ã‚°ç®¡ç†

- [ ] ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ã€ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã€ãƒ­ã‚°ã‚¤ãƒ™ãƒ³ãƒˆã®éšå±¤æ§‹é€ ã‚’ç†è§£ã—ã¦ã„ã‚‹
- [ ] ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®è¨­å®šæ–¹æ³•ã‚’çŸ¥ã£ã¦ã„ã‚‹
- [ ] ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®ç”¨é€”ã¨è¨­å®šã‚’ç†è§£ã—ã¦ã„ã‚‹
- [ ] ã‚¯ãƒ­ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ã‚°é›†ç´„ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’è¨­è¨ˆã§ãã‚‹

<details>
<summary>ğŸ“ æ¨¡ç¯„è§£ç­”ã‚’è¦‹ã‚‹</summary>

**ãƒ­ã‚°ã®éšå±¤æ§‹é€ **:
```
Log Groupï¼ˆä¾‹: /aws/lambda/my-functionï¼‰
  â””â”€ Log Streamï¼ˆä¾‹: 2026/02/03/[$LATEST]abc123ï¼‰
       â””â”€ Log Eventsï¼ˆå®Ÿéš›ã®ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰
```

**ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼**:
- ãƒ­ã‚°å†…ã®ç‰¹å®šãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã‚«ã‚¦ãƒ³ãƒˆã—ã¦ãƒ¡ãƒˆãƒªã‚¯ã‚¹åŒ–
- ä¾‹: "ERROR"ã‚’å«ã‚€ãƒ­ã‚°è¡Œã‚’ErrorCountãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨ã—ã¦ç™ºè¡Œ
- ã‚¢ãƒ©ãƒ¼ãƒ ã¨çµ„ã¿åˆã‚ã›ã¦ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥ã‚’è‡ªå‹•åŒ–

**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼**:
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ãƒ­ã‚°ã‚’å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã«è»¢é€
- é€ä¿¡å…ˆ: Lambdaã€Kinesis Data Streamsã€Kinesis Data Firehose
- ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹: ãƒ­ã‚°ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ†æã€é•·æœŸä¿å­˜ï¼ˆS3ï¼‰ã€SIEMé€£æº

**ã‚¯ãƒ­ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ã‚°é›†ç´„**:
1. å„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’è¨­å®š
2. ä¸­å¤®ãƒ­ã‚°ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®Kinesis Firehoseã«è»¢é€
3. S3ãƒã‚±ãƒƒãƒˆã«é•·æœŸä¿å­˜
4. Athena/OpenSearchã§æ¨ªæ–­åˆ†æ
</details>

### ã‚¢ãƒ©ãƒ¼ãƒ è¨­è¨ˆ

- [ ] ã‚¢ãƒ©ãƒ¼ãƒ ã®3ã¤ã®çŠ¶æ…‹ï¼ˆOKã€ALARMã€INSUFFICIENT_DATAï¼‰ã‚’ç†è§£ã—ã¦ã„ã‚‹
- [ ] è¤‡åˆã‚¢ãƒ©ãƒ¼ãƒ ï¼ˆComposite Alarmï¼‰ã®ä½¿ç”¨ã‚±ãƒ¼ã‚¹ã‚’èª¬æ˜ã§ãã‚‹
- [ ] TreatMissingDataã®è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç†è§£ã—ã¦ã„ã‚‹

<details>
<summary>ğŸ“ æ¨¡ç¯„è§£ç­”ã‚’è¦‹ã‚‹</summary>

**ã‚¢ãƒ©ãƒ¼ãƒ ã®3ã¤ã®çŠ¶æ…‹**:
- **OK**: ã—ãã„å€¤å†…ã§æ­£å¸¸
- **ALARM**: ã—ãã„å€¤ã‚’è¶…éã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
- **INSUFFICIENT_DATA**: è©•ä¾¡ã«å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆãŒä¸è¶³

**è¤‡åˆã‚¢ãƒ©ãƒ¼ãƒ **:
- è¤‡æ•°ã®ã‚¢ãƒ©ãƒ¼ãƒ ã‚’è«–ç†æ¼”ç®—ï¼ˆAND/OR/NOTï¼‰ã§çµ„ã¿åˆã‚ã›
- ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹: CPU AND ãƒ¡ãƒ¢ãƒªä¸¡æ–¹ãŒALARMã®æ™‚ã®ã¿é€šçŸ¥ï¼ˆãƒã‚¤ã‚ºå‰Šæ¸›ï¼‰
- ã‚¢ãƒ©ãƒ¼ãƒ ã‚¹ãƒˆãƒ¼ãƒ ã®é˜²æ­¢ã«æœ‰åŠ¹

**TreatMissingData**:
| è¨­å®šå€¤ | å‹•ä½œ | ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ |
|--------|------|-------------|
| missing | ç¾åœ¨ã®çŠ¶æ…‹ã‚’ç¶­æŒ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã€ä¸€èˆ¬çš„ãªä½¿ç”¨ |
| notBreaching | OKæ‰±ã„ | ãƒãƒƒãƒå‡¦ç†ãªã©æ–­ç¶šçš„ãªãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ |
| breaching | ALARMæ‰±ã„ | ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãªç›£è¦– |
| ignore | è©•ä¾¡ã‹ã‚‰é™¤å¤– | å®Œå…¨ã«ç„¡è¦– |
</details>

### ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

- [ ] EventBridgeã®ã‚¤ãƒ™ãƒ³ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¨˜è¿°ã§ãã‚‹
- [ ] ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å¼ï¼ˆcron/rateï¼‰ã‚’æ­£ã—ãè¨­å®šã§ãã‚‹
- [ ] EventBridgeã¨CloudWatch Eventsã®é•ã„ã‚’ç†è§£ã—ã¦ã„ã‚‹

<details>
<summary>ğŸ“ æ¨¡ç¯„è§£ç­”ã‚’è¦‹ã‚‹</summary>

**ã‚¤ãƒ™ãƒ³ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ä¾‹**:
```json
{
  "source": ["aws.codepipeline"],
  "detail-type": ["CodePipeline Pipeline Execution State Change"],
  "detail": {
    "state": ["FAILED", "STOPPED"]
  }
}
```

**ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å¼**:
- cron: `cron(0 9 * * ? *)` = æ¯æ—¥9:00 UTC
- rate: `rate(5 minutes)` = 5åˆ†ã”ã¨
- æ³¨æ„: cronã¯UTCåŸºæº–ã€åˆ†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯0-59

**EventBridge vs CloudWatch Events**:
- EventBridgeã¯CloudWatch Eventsã®å¾Œç¶™
- è¿½åŠ æ©Ÿèƒ½: ã‚¹ã‚­ãƒ¼ãƒãƒ¬ã‚¸ã‚¹ãƒˆãƒªã€SaaSãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼çµ±åˆã€ã‚«ã‚¹ã‚¿ãƒ ã‚¤ãƒ™ãƒ³ãƒˆãƒã‚¹
- æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯EventBridgeã‚’ä½¿ç”¨
- APIã¯äº’æ›æ€§ã‚ã‚Šï¼ˆevents.amazonaws.comï¼‰
</details>

### ã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ“ãƒªãƒ†ã‚£

- [ ] Logs Insightsã®ã‚¯ã‚¨ãƒªæ§‹æ–‡ã‚’ç†è§£ã—ã¦ã„ã‚‹
- [ ] Container Insightsã§åé›†ã•ã‚Œã‚‹ä¸»è¦ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’çŸ¥ã£ã¦ã„ã‚‹
- [ ] CloudWatch Syntheticsã®ç”¨é€”ã¨è¨­å®šæ–¹æ³•ã‚’ç†è§£ã—ã¦ã„ã‚‹

<details>
<summary>ğŸ“ æ¨¡ç¯„è§£ç­”ã‚’è¦‹ã‚‹</summary>

**Logs Insightsã‚¯ã‚¨ãƒªæ§‹æ–‡**:
```sql
fields @timestamp, @message
| filter @message like /ERROR/
| stats count() by bin(5m)
| sort @timestamp desc
| limit 100
```
ä¸»è¦ã‚³ãƒãƒ³ãƒ‰: fields, filter, stats, sort, limit, parse

**Container Insightsä¸»è¦ãƒ¡ãƒˆãƒªã‚¯ã‚¹**:
- ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼: cluster_cpu_utilization, cluster_node_count
- ã‚µãƒ¼ãƒ“ã‚¹: service_running_task_count
- Pod/Task: pod_cpu_utilization, pod_memory_utilization
- ã‚³ãƒ³ãƒ†ãƒŠ: container_restart_count

**CloudWatch Synthetics**:
- å¤–å½¢ç›£è¦–ï¼ˆåˆæˆç›£è¦–ï¼‰ã‚µãƒ¼ãƒ“ã‚¹
- Canary = Lambdaé–¢æ•°ãƒ™ãƒ¼ã‚¹ã®ç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
- ç”¨é€”: ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå¯ç”¨æ€§ã€UI/UXãƒ†ã‚¹ãƒˆã€APIç›£è¦–
- å‡ºåŠ›: HARã€ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ãƒ­ã‚°
</details>

### å®Ÿè·µã‚·ãƒŠãƒªã‚ª

- [ ] æœ¬ç•ªç’°å¢ƒã®ç›£è¦–ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’è¨­è¨ˆã§ãã‚‹
- [ ] éšœå®³ç™ºç”Ÿæ™‚ã®è‡ªå‹•å¾©æ—§ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè£…ã§ãã‚‹
- [ ] ã‚³ã‚¹ãƒˆæœ€é©åŒ–ã‚’è€ƒæ…®ã—ãŸãƒ­ã‚°ä¿æŒæˆ¦ç•¥ã‚’ç«‹æ¡ˆã§ãã‚‹

<details>
<summary>ğŸ“ æ¨¡ç¯„è§£ç­”ã‚’è¦‹ã‚‹</summary>

**æœ¬ç•ªç’°å¢ƒç›£è¦–ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**:
```
Application â†’ CloudWatch Agent â†’ Metrics + Logs
                                      â†“
                               Alarms + Dashboards
                                      â†“
                               SNS â†’ PagerDuty/Slack
                                      â†“
                               Lambda â†’ è‡ªå‹•å¾©æ—§
```

**è‡ªå‹•å¾©æ—§ãƒ•ãƒ­ãƒ¼ä¾‹**:
1. EC2 StatusCheckFailed ã‚¢ãƒ©ãƒ¼ãƒ ç™ºç«
2. EventBridgeçµŒç”±ã§Systems Manager Automationå®Ÿè¡Œ
3. AutomationãŒã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å†èµ·å‹•
4. å¾©æ—§é€šçŸ¥ã‚’SNSçµŒç”±ã§é€ä¿¡

**ãƒ­ã‚°ä¿æŒæˆ¦ç•¥**:
| ç’°å¢ƒ | ä¿æŒæœŸé–“ | ç†ç”± |
|-----|---------|------|
| é–‹ç™º | 7æ—¥ | ã‚³ã‚¹ãƒˆå‰Šæ¸› |
| ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚° | 30æ—¥ | ãƒ‡ãƒãƒƒã‚°ç”¨ |
| æœ¬ç•ª | 90æ—¥ | ç›£æŸ»ãƒ»åˆ†æ |
| ç›£æŸ»ãƒ­ã‚° | 365æ—¥ä»¥ä¸Š | ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ |

é•·æœŸä¿å­˜ã¯S3 + Glacierã€åˆ†æã¯Athenaæ´»ç”¨ã§ã‚³ã‚¹ãƒˆæœ€é©åŒ–
</details>

---

## ä»˜éŒ²A: ã‚ˆãä½¿ã†CLIã‚³ãƒãƒ³ãƒ‰

```bash
# ãƒ¡ãƒˆãƒªã‚¯ã‚¹é–¢é€£
aws cloudwatch list-metrics --namespace "AWS/EC2"
aws cloudwatch get-metric-statistics --namespace "AWS/EC2" --metric-name "CPUUtilization" ...
aws cloudwatch put-metric-data --namespace "Custom" --metric-name "MyMetric" --value 1

# ãƒ­ã‚°é–¢é€£
aws logs describe-log-groups
aws logs filter-log-events --log-group-name "/aws/lambda/func" --filter-pattern "ERROR"
aws logs start-query --log-group-name "/aws/lambda/func" --query-string "..."

# ã‚¢ãƒ©ãƒ¼ãƒ é–¢é€£
aws cloudwatch describe-alarms --state-value ALARM
aws cloudwatch put-metric-alarm --alarm-name "..." --metric-name "..." ...
aws cloudwatch set-alarm-state --alarm-name "..." --state-value OK --state-reason "Manual reset"

# EventBridgeé–¢é€£
aws events list-rules
aws events put-rule --name "..." --event-pattern "..."
aws events put-targets --rule "..." --targets "..."
```

---

## ä»˜éŒ²B: å‚è€ƒãƒªãƒ³ã‚¯

- [CloudWatch ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/)
- [CloudWatch Logs ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/)
- [EventBridge ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰](https://docs.aws.amazon.com/eventbridge/latest/userguide/)
- [CloudWatch Synthetics ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch_Synthetics_Canaries.html)

---

**ä½œæˆæ—¥**: 2026-02-03
**æœ€çµ‚æ›´æ–°**: 2026-02-03
**æ¤œè¨¼ç’°å¢ƒ**: AWS ap-northeast-1 ãƒªãƒ¼ã‚¸ãƒ§ãƒ³
