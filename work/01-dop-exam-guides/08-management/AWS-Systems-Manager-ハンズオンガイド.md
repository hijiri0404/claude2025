# AWS Systems Manager (SSM) ãƒãƒ³ã‚ºã‚ªãƒ³ã‚¬ã‚¤ãƒ‰

> **æ¤œè¨¼ç’°å¢ƒ**: AWS ap-northeast-1 (æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³) / 2026-02-04 æ¤œè¨¼æ¸ˆã¿
> **DOPè©¦é¨“å¯¾å¿œ**: AWS DevOps Professional (DOP-C02) å‡ºé¡Œç¯„å›²

## ç›®æ¬¡

### åŸºç¤ç·¨
1. [ã¯ã˜ã‚ã«ï¼ˆåˆå­¦è€…å‘ã‘ï¼‰](#ã¯ã˜ã‚ã«åˆå­¦è€…å‘ã‘)
2. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦](#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦)
3. [å‰ææ¡ä»¶](#å‰ææ¡ä»¶)

### ãƒãƒ³ã‚ºã‚ªãƒ³ç·¨
4. [Parameter Store](#parameter-store) **[æ¤œè¨¼æ¸ˆ]**
5. [Run Command](#run-command) **[æ¤œè¨¼æ¸ˆ]**
6. [Automation](#automation)
7. [Session Manager](#session-manager)
8. [Patch Manager](#patch-manager)
9. [State Manager](#state-manager)

### DOPè©¦é¨“å¯¾ç­–
10. [DOPè©¦é¨“ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ](#dopè©¦é¨“ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ)
11. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
12. [ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹](#ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹)

---

## ã¯ã˜ã‚ã«ï¼ˆåˆå­¦è€…å‘ã‘ï¼‰

### Systems Managerã¨ã¯ï¼Ÿ

**AWS Systems Manager (SSM)** ã¯ã€AWSãƒªã‚½ãƒ¼ã‚¹ã‚„ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ã‚µãƒ¼ãƒãƒ¼ã‚’çµ±åˆç®¡ç†ã™ã‚‹ãŸã‚ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     AWS Systems Manager ã®å…¨ä½“åƒ                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    é‹ç”¨ç®¡ç† (Operations)                         â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  Explorer    â”‚  OpsCenter   â”‚  Incident    â”‚  CloudWatch      â”‚   â”‚
â”‚  â”‚  (å¯è¦–åŒ–)    â”‚  (å•é¡Œç®¡ç†)   â”‚  Manager     â”‚  Dashboard       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ (Actions)                          â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  Automation  â”‚  Run Command â”‚  Session     â”‚  Maintenance     â”‚   â”‚
â”‚  â”‚  (è‡ªå‹•åŒ–)    â”‚  (ã‚³ãƒãƒ³ãƒ‰)   â”‚  Manager     â”‚  Windows         â”‚   â”‚
â”‚  â”‚              â”‚              â”‚  (SSHä»£æ›¿)   â”‚  (ä¿å®ˆæœŸé–“)      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç®¡ç† (Instances)                  â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  Fleet       â”‚  Compliance  â”‚  Inventory   â”‚  Hybrid          â”‚   â”‚
â”‚  â”‚  Manager     â”‚  (æº–æ‹ çŠ¶æ³)   â”‚  (è³‡ç”£ç®¡ç†)   â”‚  Activations     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    å¤‰æ›´ç®¡ç† (Change)                             â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  Change      â”‚  Change      â”‚  Patch       â”‚  State           â”‚   â”‚
â”‚  â”‚  Manager     â”‚  Calendar    â”‚  Manager     â”‚  Manager         â”‚   â”‚
â”‚  â”‚  (å¤‰æ›´ç®¡ç†)   â”‚  (å¤‰æ›´ç¦æ­¢æœŸé–“)â”‚  (ãƒ‘ãƒƒãƒç®¡ç†) â”‚  (çŠ¶æ…‹ç¶­æŒ)      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    å…±æœ‰ãƒªã‚½ãƒ¼ã‚¹ (Shared Resources)               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  Parameter   â”‚  Documents (SSM Documents)                        â”‚   â”‚
â”‚  â”‚  Store       â”‚  - Command documents                              â”‚   â”‚
â”‚  â”‚  (è¨­å®šä¿å­˜)   â”‚  - Automation runbooks                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãªãœSystems Managerã‚’ä½¿ã†ã®ã‹ï¼Ÿ

| å¾“æ¥ã®æ–¹æ³• | Systems Manager |
|-----------|-----------------|
| SSHã§ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã—ã¦æ“ä½œ | Session Managerã§ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰æ¥ç¶šï¼ˆãƒãƒ¼ãƒˆé–‹æ”¾ä¸è¦ï¼‰ |
| è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚µãƒ¼ãƒãƒ¼ã«é…ç½® | Parameter Storeã§ä¸€å…ƒç®¡ç† |
| cronã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ | Run Command/Automationã§å®Ÿè¡Œãƒ»ç›£è¦– |
| æ‰‹å‹•ã§ãƒ‘ãƒƒãƒé©ç”¨ | Patch Managerã§è‡ªå‹•åŒ– |
| æ§‹æˆç®¡ç†ãƒ„ãƒ¼ãƒ«ï¼ˆAnsibleç­‰ï¼‰ã‚’åˆ¥é€”å°å…¥ | State Managerã§çµ±åˆç®¡ç† |

### DOPè©¦é¨“ã§ã®å‡ºé¡Œå‚¾å‘

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | å‡ºé¡Œé »åº¦ | é‡è¦ãƒˆãƒ”ãƒƒã‚¯ |
|---------------|---------|-------------|
| **Parameter Store** | é«˜ | SecureStringã€éšå±¤åŒ–ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚° |
| **Run Command** | é«˜ | å¤§è¦æ¨¡å®Ÿè¡Œã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæŒ‡å®šã€ãƒ¬ãƒ¼ãƒˆåˆ¶å¾¡ |
| **Automation** | é«˜ | æ‰¿èªãƒ•ãƒ­ãƒ¼ã€ãƒãƒ«ãƒã‚¢ã‚«ã‚¦ãƒ³ãƒˆå®Ÿè¡Œ |
| **Session Manager** | ä¸­ | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼ˆSSHä¸è¦ï¼‰ã€ç›£æŸ»ãƒ­ã‚° |
| **Patch Manager** | ä¸­ | ãƒ‘ãƒƒãƒãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ |
| **State Manager** | ä½ | æ§‹æˆãƒ‰ãƒªãƒ•ãƒˆæ¤œå‡º |

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

### SSM Agentã®é€šä¿¡ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SSM Agent é€šä¿¡ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  EC2         â”‚                      â”‚  Systems Manager             â”‚ â”‚
â”‚  â”‚  Instance    â”‚                      â”‚  Service Endpoints           â”‚ â”‚
â”‚  â”‚              â”‚    HTTPS (443)       â”‚                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚  ssm.ap-northeast-1          â”‚ â”‚
â”‚  â”‚  â”‚ SSM    â”‚  â”‚                      â”‚  ssmmessages.ap-northeast-1  â”‚ â”‚
â”‚  â”‚  â”‚ Agent  â”‚  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  ec2messages.ap-northeast-1  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    (ãƒãƒ¼ãƒªãƒ³ã‚°)       â”‚                              â”‚ â”‚
â”‚  â”‚              â”‚                      â”‚                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                                                                â”‚
â”‚         â”‚ IAM Role                                                       â”‚
â”‚         â–¼                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚  â”‚ Instance     â”‚  å¿…è¦ãªãƒãƒªã‚·ãƒ¼:                                       â”‚
â”‚  â”‚ Profile      â”‚  - AmazonSSMManagedInstanceCore                       â”‚
â”‚  â”‚ (IAM Role)   â”‚  - (ã‚ªãƒ—ã‚·ãƒ§ãƒ³) CloudWatchAgentServerPolicy           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚
â”‚                                                                          â”‚
â”‚  â˜… ãƒã‚¤ãƒ³ãƒˆ: ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰ãƒãƒ¼ãƒˆã¯ä¸è¦ï¼ˆSSM AgentãŒHTTPSã§ãƒãƒ¼ãƒªãƒ³ã‚°ï¼‰      â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæ§‹æˆï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆç”¨ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã§ã®SSMæ¥ç¶š                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚            Private Subnet            â”‚                                â”‚
â”‚  â”‚                                      â”‚                                â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                                â”‚
â”‚  â”‚  â”‚  EC2         â”‚   â”‚  VPC       â”‚  â”‚                                â”‚
â”‚  â”‚  â”‚  (SSM Agent) â”‚â”€â”€â–ºâ”‚  Endpoint  â”‚â”€â”€â”¼â”€â”€â–º SSM Service                 â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚            â”‚  â”‚                                â”‚
â”‚  â”‚                      â”‚  ãƒ»ssm     â”‚  â”‚                                â”‚
â”‚  â”‚                      â”‚  ãƒ»ssmmsg  â”‚  â”‚                                â”‚
â”‚  â”‚                      â”‚  ãƒ»ec2msg  â”‚  â”‚                                â”‚
â”‚  â”‚                      â”‚  ãƒ»s3(gw)  â”‚  â”‚                                â”‚
â”‚  â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                â”‚
â”‚  â”‚                                      â”‚                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                                                                          â”‚
â”‚  å¿…è¦ãªVPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆInterfaceå‹ï¼‰:                                  â”‚
â”‚  - com.amazonaws.ap-northeast-1.ssm                                      â”‚
â”‚  - com.amazonaws.ap-northeast-1.ssmmessages                              â”‚
â”‚  - com.amazonaws.ap-northeast-1.ec2messages                              â”‚
â”‚  - com.amazonaws.ap-northeast-1.s3 (Gatewayå‹)                           â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å‰ææ¡ä»¶

### å¿…è¦ãªæ¨©é™

```bash
# è‡ªåˆ†ã®IAMãƒ¦ãƒ¼ã‚¶ãƒ¼/ãƒ­ãƒ¼ãƒ«ã«ä»¥ä¸‹ã®æ¨©é™ãŒå¿…è¦
# - AmazonSSMFullAccessï¼ˆå­¦ç¿’ç”¨ï¼‰
# - æœ¬ç•ªç’°å¢ƒã§ã¯æœ€å°æ¨©é™ã«çµã‚‹ã“ã¨

# æ¨©é™ç¢ºèª
aws sts get-caller-identity
aws iam list-attached-user-policies --user-name $(aws sts get-caller-identity --query 'Arn' --output text | cut -d'/' -f2)
```

### SSM Agentå¯¾å¿œAMI

```bash
# Amazon Linux 2/2023ã€Ubuntu 16.04ä»¥é™ã€Windows Server 2016ä»¥é™ã¯
# SSM AgentãŒãƒ—ãƒªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿

# SSM Agent ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèªï¼ˆEC2å†…ã§å®Ÿè¡Œï¼‰
amazon-ssm-agent --version
```

---

## Parameter Store

> **æ¤œè¨¼æ¸ˆã¿**: 2026-02-04 ap-northeast-1 ã§å‹•ä½œç¢ºèªæ¸ˆã¿
>
> **DOPè©¦é¨“ãƒã‚¤ãƒ³ãƒˆ**: SecureString ã®æš—å·åŒ–ã€éšå±¤åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã€
> Secrets Manager ã¨ã®ä½¿ã„åˆ†ã‘ãŒé »å‡º

### Parameter Store ã¨ã¯ï¼Ÿ

è¨­å®šå€¤ã‚„ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’å®‰å…¨ã«ä¿å­˜ãƒ»å–å¾—ã™ã‚‹ãŸã‚ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Parameter Store ã®æ§‹é€                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  /myapp/                                                         â”‚
â”‚  â”œâ”€â”€ dev/                    â† éšå±¤åŒ–ã§ç’°å¢ƒã‚’åˆ†é›¢                â”‚
â”‚  â”‚   â”œâ”€â”€ db-host            (String)                            â”‚
â”‚  â”‚   â”œâ”€â”€ db-password        (SecureString) â† KMSæš—å·åŒ–          â”‚
â”‚  â”‚   â””â”€â”€ api-key            (SecureString)                      â”‚
â”‚  â”œâ”€â”€ prod/                                                       â”‚
â”‚  â”‚   â”œâ”€â”€ db-host            (String)                            â”‚
â”‚  â”‚   â”œâ”€â”€ db-password        (SecureString)                      â”‚
â”‚  â”‚   â””â”€â”€ api-key            (SecureString)                      â”‚
â”‚  â””â”€â”€ shared/                 â† å…±é€šè¨­å®š                          â”‚
â”‚      â””â”€â”€ log-level          (String)                            â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒãƒ³ã‚ºã‚ªãƒ³: Parameter Store ã®åŸºæœ¬æ“ä½œ

```bash
# ========================================
# 1. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ä½œæˆ
# ========================================

# Stringå‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆæš—å·åŒ–ãªã—ï¼‰
aws ssm put-parameter \
  --name "/myapp/dev/db-host" \
  --type String \
  --value "dev-db.example.com" \
  --description "é–‹ç™ºç’°å¢ƒã®DBãƒ›ã‚¹ãƒˆ"

# SecureStringå‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆKMSæš—å·åŒ–ï¼‰
# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯aws/ssmã‚­ãƒ¼ã§æš—å·åŒ–
aws ssm put-parameter \
  --name "/myapp/dev/db-password" \
  --type SecureString \
  --value "MySecretPassword123" \
  --description "é–‹ç™ºç’°å¢ƒã®DBãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰"

# ã‚«ã‚¹ã‚¿ãƒ KMSã‚­ãƒ¼ã§æš—å·åŒ–
aws ssm put-parameter \
  --name "/myapp/prod/db-password" \
  --type SecureString \
  --value "ProdSecretPassword456" \
  --key-id "alias/myapp-key" \
  --description "æœ¬ç•ªç’°å¢ƒã®DBãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰"

# ========================================
# 2. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å–å¾—
# ========================================

# å˜ä¸€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾—
aws ssm get-parameter \
  --name "/myapp/dev/db-host"

# SecureString ã‚’å¾©å·åŒ–ã—ã¦å–å¾—
aws ssm get-parameter \
  --name "/myapp/dev/db-password" \
  --with-decryption

# éšå±¤ä¸‹ã®å…¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾—
aws ssm get-parameters-by-path \
  --path "/myapp/dev" \
  --recursive \
  --with-decryption

# ========================================
# 3. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ›´æ–°ï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ï¼‰
# ========================================

# ä¸Šæ›¸ãæ›´æ–°ï¼ˆæ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä½œæˆï¼‰
aws ssm put-parameter \
  --name "/myapp/dev/db-host" \
  --type String \
  --value "new-dev-db.example.com" \
  --overwrite

# ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´ã®ç¢ºèª
aws ssm get-parameter-history \
  --name "/myapp/dev/db-host"

# ç‰¹å®šãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å–å¾—
aws ssm get-parameter \
  --name "/myapp/dev/db-host:1"  # ãƒãƒ¼ã‚¸ãƒ§ãƒ³1ã‚’å–å¾—

# ========================================
# 4. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å‰Šé™¤
# ========================================

aws ssm delete-parameter \
  --name "/myapp/dev/db-host"

# è¤‡æ•°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä¸€æ‹¬å‰Šé™¤
aws ssm delete-parameters \
  --names "/myapp/dev/db-password" "/myapp/prod/db-password"
```

### Parameter Store ã®æ–™é‡‘ä½“ç³»

| ã‚¿ã‚¤ãƒ— | Standard | Advanced |
|--------|----------|----------|
| æœ€å¤§ã‚µã‚¤ã‚º | 4KB | 8KB |
| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•° | 10,000 | 100,000+ |
| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒªã‚·ãƒ¼ | Ã— | â—‹ |
| æ–™é‡‘ | ç„¡æ–™ | $0.05/ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿/æœˆ |

### buildspec.yml ã§ã®ä½¿ç”¨ä¾‹

```yaml
version: 0.2

env:
  # Parameter Store ã‹ã‚‰å€¤ã‚’å–å¾—
  parameter-store:
    DB_HOST: /myapp/dev/db-host
    DB_PASSWORD: /myapp/dev/db-password  # è‡ªå‹•ã§å¾©å·åŒ–ã•ã‚Œã‚‹

phases:
  build:
    commands:
      - echo "Connecting to $DB_HOST"
      # DB_PASSWORD ã¯ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦åˆ©ç”¨å¯èƒ½
```

### Lambda ã§ã®ä½¿ç”¨ä¾‹

```python
import boto3
from botocore.exceptions import ClientError

def get_parameter(name, decrypt=True):
    """Parameter Store ã‹ã‚‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å–å¾—"""
    ssm = boto3.client('ssm')
    try:
        response = ssm.get_parameter(
            Name=name,
            WithDecryption=decrypt
        )
        return response['Parameter']['Value']
    except ClientError as e:
        print(f"Error: {e}")
        raise

def lambda_handler(event, context):
    # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾—
    db_host = get_parameter('/myapp/prod/db-host', decrypt=False)
    db_password = get_parameter('/myapp/prod/db-password', decrypt=True)

    # æ¥ç¶šå‡¦ç†...
    return {'statusCode': 200}
```

---

## Run Command

> **æ¤œè¨¼æ¸ˆã¿**: 2026-02-04 ap-northeast-1 ã§å‹•ä½œç¢ºèªæ¸ˆã¿
>
> **DOPè©¦é¨“ãƒã‚¤ãƒ³ãƒˆ**: å¤§è¦æ¨¡å®Ÿè¡Œã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæŒ‡å®šæ–¹æ³•ã€ãƒ¬ãƒ¼ãƒˆåˆ¶å¾¡ã€
> å‡ºåŠ›å…ˆï¼ˆS3/CloudWatch Logsï¼‰

### Run Command ã¨ã¯ï¼Ÿ

EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å¯¾ã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’ãƒªãƒ¢ãƒ¼ãƒˆå®Ÿè¡Œã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Run Command ã®å®Ÿè¡Œãƒ•ãƒ­ãƒ¼                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    1. ã‚³ãƒãƒ³ãƒ‰é€ä¿¡     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ç®¡ç†è€…    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  Systems Manager             â”‚ â”‚
â”‚  â”‚  (CLI/     â”‚                        â”‚                              â”‚ â”‚
â”‚  â”‚  Console)  â”‚                        â”‚  ãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé¸æŠ           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚  ãƒ»ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæŒ‡å®š            â”‚ â”‚
â”‚                                        â”‚  ãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š            â”‚ â”‚
â”‚                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                        â”‚                 â”‚
â”‚                           2. ã‚³ãƒãƒ³ãƒ‰ã‚’ã‚­ãƒ¥ãƒ¼ã‚¤ãƒ³ã‚°     â”‚                 â”‚
â”‚                                                        â–¼                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹                        â”‚ â”‚
â”‚  â”‚                                                                     â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚ â”‚
â”‚  â”‚  â”‚ Instance â”‚  â”‚ Instance â”‚  â”‚ Instance â”‚  â”‚ Instance â”‚   ...     â”‚ â”‚
â”‚  â”‚  â”‚ (Agent)  â”‚  â”‚ (Agent)  â”‚  â”‚ (Agent)  â”‚  â”‚ (Agent)  â”‚          â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â”‚ â”‚
â”‚  â”‚       â”‚             â”‚             â”‚             â”‚                  â”‚ â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â”‚
â”‚  â”‚                            â”‚                                        â”‚ â”‚
â”‚  â”‚                3. ãƒãƒ¼ãƒªãƒ³ã‚°ã§ã‚³ãƒãƒ³ãƒ‰å–å¾—ãƒ»å®Ÿè¡Œ                      â”‚ â”‚
â”‚  â”‚                            â”‚                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                               â”‚                                          â”‚
â”‚                               â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  4. çµæœã®ä¿å­˜å…ˆ                                                    â”‚ â”‚
â”‚  â”‚  ãƒ»S3ãƒã‚±ãƒƒãƒˆï¼ˆå¤§é‡å‡ºåŠ›å‘ã‘ï¼‰                                        â”‚ â”‚
â”‚  â”‚  ãƒ»CloudWatch Logsï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–å‘ã‘ï¼‰                           â”‚ â”‚
â”‚  â”‚  ãƒ»SSMï¼ˆ2500æ–‡å­—ã¾ã§ï¼‰                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒãƒ³ã‚ºã‚ªãƒ³: Run Command ã®åŸºæœ¬æ“ä½œ

```bash
# ========================================
# 1. ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ç¢ºèª
# ========================================

# SSM ã«ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä¸€è¦§
aws ssm describe-instance-information \
  --query 'InstanceInformationList[*].{
    InstanceId:InstanceId,
    PingStatus:PingStatus,
    AgentVersion:AgentVersion,
    PlatformType:PlatformType
  }' \
  --output table

# ========================================
# 2. åˆ©ç”¨å¯èƒ½ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç¢ºèª
# ========================================

# AWSæä¾›ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸€è¦§
aws ssm list-documents \
  --filters "Key=Owner,Values=Amazon" \
  --query 'DocumentIdentifiers[*].{Name:Name,DocumentType:DocumentType}' \
  --output table | head -20

# ã‚ˆãä½¿ã†ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ:
# - AWS-RunShellScript: Linuxã‚·ã‚§ãƒ«ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
# - AWS-RunPowerShellScript: PowerShellã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
# - AWS-UpdateSSMAgent: SSM Agentã®æ›´æ–°
# - AWS-ConfigureAWSPackage: ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

# ========================================
# 3. ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œ
# ========================================

# å˜ä¸€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¸ã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
aws ssm send-command \
  --document-name "AWS-RunShellScript" \
  --targets "Key=instanceids,Values=i-1234567890abcdef0" \
  --parameters 'commands=["echo Hello from SSM", "hostname", "uptime"]' \
  --comment "ãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰"

# ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹ã§ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæŒ‡å®šï¼ˆæœ¬ç•ªã§æ¨å¥¨ï¼‰
aws ssm send-command \
  --document-name "AWS-RunShellScript" \
  --targets "Key=tag:Environment,Values=dev" \
  --parameters 'commands=["df -h", "free -m"]' \
  --comment "é–‹ç™ºç’°å¢ƒã®ãƒ‡ã‚£ã‚¹ã‚¯ãƒ»ãƒ¡ãƒ¢ãƒªç¢ºèª"

# ========================================
# 4. å®Ÿè¡Œçµæœã®ç¢ºèª
# ========================================

# ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå±¥æ­´
aws ssm list-commands \
  --query 'Commands[*].{
    CommandId:CommandId,
    Status:Status,
    RequestedDateTime:RequestedDateTime,
    Comment:Comment
  }' \
  --output table

# ç‰¹å®šã‚³ãƒãƒ³ãƒ‰ã®è©³ç´°
COMMAND_ID="your-command-id"
aws ssm list-command-invocations \
  --command-id $COMMAND_ID \
  --details \
  --query 'CommandInvocations[*].{
    InstanceId:InstanceId,
    Status:Status,
    Output:CommandPlugins[0].Output
  }'

# ========================================
# 5. ãƒ¬ãƒ¼ãƒˆåˆ¶å¾¡ï¼ˆå¤§è¦æ¨¡å®Ÿè¡Œæ™‚ã«é‡è¦ï¼‰
# ========================================

# 50å°ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å¯¾ã—ã¦10%ãšã¤å®Ÿè¡Œ
aws ssm send-command \
  --document-name "AWS-RunShellScript" \
  --targets "Key=tag:Environment,Values=prod" \
  --parameters 'commands=["systemctl restart myapp"]' \
  --max-concurrency "10%" \
  --max-errors "5%" \
  --comment "æœ¬ç•ªç’°å¢ƒãƒ­ãƒ¼ãƒªãƒ³ã‚°å†èµ·å‹•"

# çµ¶å¯¾æ•°ã§æŒ‡å®š
aws ssm send-command \
  --document-name "AWS-RunShellScript" \
  --targets "Key=tag:Environment,Values=prod" \
  --parameters 'commands=["yum update -y"]' \
  --max-concurrency "5" \
  --max-errors "2" \
  --comment "5å°ãšã¤é †æ¬¡ãƒ‘ãƒƒãƒé©ç”¨"
```

### ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæŒ‡å®šæ–¹æ³•ã®æ¯”è¼ƒ

| æ–¹æ³• | æ§‹æ–‡ | ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ |
|------|------|-------------|
| ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ID | `Key=instanceids,Values=i-xxx` | ç‰¹å®šã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ |
| ã‚¿ã‚° | `Key=tag:Environment,Values=dev` | ç’°å¢ƒåˆ¥å®Ÿè¡Œ |
| ãƒªã‚½ãƒ¼ã‚¹ã‚°ãƒ«ãƒ¼ãƒ— | `Key=resource-groups:Name,Values=MyGroup` | ã‚°ãƒ«ãƒ¼ãƒ—å˜ä½ |
| å…¨ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ | `Key=InstanceIds,Values=*` | å…¨å°å®Ÿè¡Œï¼ˆæ³¨æ„ï¼‰ |

---

## Automation

> **DOPè©¦é¨“ãƒã‚¤ãƒ³ãƒˆ**: æ‰¿èªãƒ•ãƒ­ãƒ¼ã€ãƒãƒ«ãƒã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ»ãƒãƒ«ãƒãƒªãƒ¼ã‚¸ãƒ§ãƒ³å®Ÿè¡Œã€
> Change Calendar ã¨ã®é€£æº

### Automation ã¨ã¯ï¼Ÿ

è¤‡æ•°ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’è‡ªå‹•åŒ–ã™ã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³ã§ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Automation Runbook ã®ä¾‹                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  Step 1      â”‚    â”‚  Step 2      â”‚    â”‚  Step 3      â”‚              â”‚
â”‚  â”‚              â”‚    â”‚              â”‚    â”‚              â”‚              â”‚
â”‚  â”‚  AMIä½œæˆ     â”‚ â”€â–º â”‚  æ‰¿èªå¾…ã¡    â”‚ â”€â–º â”‚  Launch      â”‚              â”‚
â”‚  â”‚              â”‚    â”‚  (æ‰‹å‹•)      â”‚    â”‚  Instance    â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                              â”‚                                          â”‚
â”‚                              â”‚ æ‰¿èª or æ‹’å¦                             â”‚
â”‚                              â–¼                                          â”‚
â”‚                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚                       â”‚  æ‹’å¦ã•ã‚ŒãŸ   â”‚                                  â”‚
â”‚                       â”‚  å ´åˆã¯çµ‚äº†   â”‚                                  â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AWSæä¾›ã® Automation Runbook

| Runbook | ç”¨é€” |
|---------|------|
| `AWS-CreateImage` | EC2ã‹ã‚‰AMIä½œæˆ |
| `AWS-UpdateLinuxAmi` | AMIã®ãƒ‘ãƒƒãƒé©ç”¨ãƒ»æ›´æ–° |
| `AWS-StopEC2Instance` | EC2åœæ­¢ |
| `AWS-RestartEC2Instance` | EC2å†èµ·å‹• |
| `AWS-PatchInstanceWithRollback` | ãƒ‘ãƒƒãƒé©ç”¨ï¼ˆå¤±æ•—æ™‚ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰ |

### ãƒãƒ³ã‚ºã‚ªãƒ³: ã‚«ã‚¹ã‚¿ãƒ  Automation Runbook

```yaml
# automation-runbook.yaml
# AMIä½œæˆ â†’ æ‰¿èª â†’ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹èµ·å‹• ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

schemaVersion: '0.3'
description: 'AMIä½œæˆå¾Œã€æ‰¿èªã‚’çµŒã¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’èµ·å‹•'
assumeRole: '{{AutomationAssumeRole}}'

parameters:
  SourceInstanceId:
    type: String
    description: AMIä½œæˆå…ƒã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ID
  AutomationAssumeRole:
    type: String
    description: AutomationãŒä½¿ç”¨ã™ã‚‹IAMãƒ­ãƒ¼ãƒ«
  ApproverArn:
    type: String
    description: æ‰¿èªè€…ã®IAM ARN

mainSteps:
  # Step 1: AMIä½œæˆ
  - name: createImage
    action: aws:createImage
    inputs:
      InstanceId: '{{SourceInstanceId}}'
      ImageName: 'Automation-AMI-{{global:DATE_TIME}}'
      NoReboot: true
    outputs:
      - Name: ImageId
        Selector: $.ImageId
        Type: String

  # Step 2: æ‰‹å‹•æ‰¿èª
  - name: approveImage
    action: aws:approve
    inputs:
      NotificationArn: 'arn:aws:sns:ap-northeast-1:123456789012:ApprovalTopic'
      Message: 'AMI {{createImage.ImageId}} ã®ä½œæˆãŒå®Œäº†ã—ã¾ã—ãŸã€‚æ‰¿èªã—ã¦ãã ã•ã„ã€‚'
      MinRequiredApprovals: 1
      Approvers:
        - '{{ApproverArn}}'

  # Step 3: ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹èµ·å‹•
  - name: launchInstance
    action: aws:runInstances
    inputs:
      ImageId: '{{createImage.ImageId}}'
      InstanceType: t3.micro
      MinInstanceCount: 1
      MaxInstanceCount: 1

outputs:
  - createImage.ImageId
  - launchInstance.InstanceIds
```

```bash
# Runbook ã®ä½œæˆ
aws ssm create-document \
  --name "MyApp-CreateAndLaunch" \
  --document-type "Automation" \
  --content file://automation-runbook.yaml

# Automation ã®å®Ÿè¡Œ
aws ssm start-automation-execution \
  --document-name "MyApp-CreateAndLaunch" \
  --parameters '{
    "SourceInstanceId": ["i-1234567890abcdef0"],
    "AutomationAssumeRole": ["arn:aws:iam::123456789012:role/AutomationRole"],
    "ApproverArn": ["arn:aws:iam::123456789012:user/admin"]
  }'

# å®Ÿè¡ŒçŠ¶æ³ã®ç¢ºèª
aws ssm describe-automation-executions \
  --query 'AutomationExecutionMetadataList[*].{
    ExecutionId:AutomationExecutionId,
    Status:AutomationExecutionStatus,
    DocumentName:DocumentName
  }' --output table
```

---

## Session Manager

> **DOPè©¦é¨“ãƒã‚¤ãƒ³ãƒˆ**: SSHä¸è¦ã®ã‚»ã‚­ãƒ¥ã‚¢ã‚¢ã‚¯ã‚»ã‚¹ã€ç›£æŸ»ãƒ­ã‚°ã€
> ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°

### Session Manager ã¨ã¯ï¼Ÿ

SSHã‚­ãƒ¼ã‚„ãƒãƒ¼ãƒˆé–‹æ”¾ãªã—ã§EC2ã«æ¥ç¶šã§ãã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ãƒ¡ãƒªãƒƒãƒˆ

| å¾“æ¥ã®SSH | Session Manager |
|-----------|-----------------|
| ãƒãƒ¼ãƒˆ22ã‚’é–‹æ”¾ãŒå¿…è¦ | ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰ãƒãƒ¼ãƒˆä¸è¦ |
| SSHã‚­ãƒ¼ã®ç®¡ç†ãŒå¿…è¦ | IAMã§èªè¨¼ |
| è¸ã¿å°ã‚µãƒ¼ãƒãƒ¼ãŒå¿…è¦ | ç›´æ¥æ¥ç¶šå¯èƒ½ |
| ãƒ­ã‚°å–å¾—ãŒå›°é›£ | CloudWatch Logs/S3ã«è‡ªå‹•è¨˜éŒ² |

### ãƒãƒ³ã‚ºã‚ªãƒ³: Session Manager ã®ä½¿ç”¨

```bash
# ========================================
# 1. ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®é–‹å§‹
# ========================================

# CLIã‹ã‚‰ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹
aws ssm start-session --target i-1234567890abcdef0

# ========================================
# 2. ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
# ========================================

# ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒ¼ãƒˆ8080ã‚’EC2ã®ãƒãƒ¼ãƒˆ80ã«ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰
aws ssm start-session \
  --target i-1234567890abcdef0 \
  --document-name AWS-StartPortForwardingSession \
  --parameters '{"portNumber":["80"],"localPortNumber":["8080"]}'

# RDSæ¥ç¶šï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆå†…ã®RDSã«æ¥ç¶šï¼‰
aws ssm start-session \
  --target i-1234567890abcdef0 \
  --document-name AWS-StartPortForwardingSessionToRemoteHost \
  --parameters '{
    "host":["mydb.xxx.ap-northeast-1.rds.amazonaws.com"],
    "portNumber":["3306"],
    "localPortNumber":["3306"]
  }'

# ========================================
# 3. ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ­ã‚°ã®è¨­å®š
# ========================================

# Session Managerè¨­å®šã‚’CloudFormationã§å®šç¾©
cat > session-manager-settings.yaml << 'EOF'
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  SessionManagerLogGroup:
    Type: AWS::Logs::LogGroup
    Properties:
      LogGroupName: /aws/ssm/session-manager
      RetentionInDays: 30

  SessionManagerLogBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub 'session-manager-logs-${AWS::AccountId}'
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: AES256
EOF
```

---

## Patch Manager

> **DOPè©¦é¨“ãƒã‚¤ãƒ³ãƒˆ**: ãƒ‘ãƒƒãƒãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã€
> ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ãƒ¬ãƒãƒ¼ãƒˆ

### Patch Manager ã¨ã¯ï¼Ÿ

EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒ‘ãƒƒãƒé©ç”¨ã‚’è‡ªå‹•åŒ–ã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Patch Manager ã®æ§‹æˆè¦ç´                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚  Patch Baseline  â”‚  ã©ã®ãƒ‘ãƒƒãƒã‚’é©ç”¨ã™ã‚‹ã‹ã®ãƒ«ãƒ¼ãƒ«                    â”‚
â”‚  â”‚                  â”‚  - é‡è¦åº¦ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆCritical, Importantç­‰ï¼‰       â”‚
â”‚  â”‚                  â”‚  - æ‰¿èªãƒ«ãƒ¼ãƒ«ï¼ˆè‡ªå‹•æ‰¿èªã®æ—¥æ•°ï¼‰                    â”‚
â”‚  â”‚                  â”‚  - é™¤å¤–ãƒ‘ãƒƒãƒ                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚           â”‚                                                              â”‚
â”‚           â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚  Patch Group     â”‚  ãƒ‘ãƒƒãƒãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã‚’é©ç”¨ã™ã‚‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç¾¤        â”‚
â”‚  â”‚                  â”‚  ã‚¿ã‚°: "Patch Group" = "production"               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚           â”‚                                                              â”‚
â”‚           â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚  Maintenance     â”‚  ã„ã¤ãƒ‘ãƒƒãƒã‚’é©ç”¨ã™ã‚‹ã‹                            â”‚
â”‚  â”‚  Window          â”‚  - ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆcronå¼ï¼‰                          â”‚
â”‚  â”‚                  â”‚  - æœŸé–“ï¼ˆ1ã€œ24æ™‚é–“ï¼‰                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒãƒ³ã‚ºã‚ªãƒ³: Patch Manager ã®è¨­å®š

```bash
# ========================================
# 1. ã‚«ã‚¹ã‚¿ãƒ ãƒ‘ãƒƒãƒãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã®ä½œæˆ
# ========================================

aws ssm create-patch-baseline \
  --name "MyApp-PatchBaseline" \
  --operating-system "AMAZON_LINUX_2" \
  --approval-rules '{
    "PatchRules": [
      {
        "PatchFilterGroup": {
          "PatchFilters": [
            {"Key": "CLASSIFICATION", "Values": ["Security", "Bugfix"]},
            {"Key": "SEVERITY", "Values": ["Critical", "Important"]}
          ]
        },
        "ApproveAfterDays": 7,
        "ComplianceLevel": "CRITICAL"
      }
    ]
  }' \
  --description "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‘ãƒƒãƒã‚’7æ—¥å¾Œã«è‡ªå‹•æ‰¿èª"

# ========================================
# 2. ãƒ‘ãƒƒãƒã‚°ãƒ«ãƒ¼ãƒ—ã®ç™»éŒ²
# ========================================

# ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã‚¿ã‚°ã‚’è¨­å®š
aws ec2 create-tags \
  --resources i-1234567890abcdef0 \
  --tags "Key=Patch Group,Value=production"

# ãƒ‘ãƒƒãƒãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã«ãƒ‘ãƒƒãƒã‚°ãƒ«ãƒ¼ãƒ—ã‚’é–¢é€£ä»˜ã‘
aws ssm register-patch-baseline-for-patch-group \
  --baseline-id pb-0123456789abcdef0 \
  --patch-group "production"

# ========================================
# 3. å³åº§ã«ãƒ‘ãƒƒãƒã‚¹ã‚­ãƒ£ãƒ³
# ========================================

aws ssm send-command \
  --document-name "AWS-RunPatchBaseline" \
  --targets "Key=tag:Patch Group,Values=production" \
  --parameters '{"Operation":["Scan"]}' \
  --comment "ãƒ‘ãƒƒãƒã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ã‚¹ã‚­ãƒ£ãƒ³"

# ========================================
# 4. ãƒ‘ãƒƒãƒã®é©ç”¨
# ========================================

aws ssm send-command \
  --document-name "AWS-RunPatchBaseline" \
  --targets "Key=tag:Patch Group,Values=production" \
  --parameters '{"Operation":["Install"]}' \
  --max-concurrency "10%" \
  --max-errors "5%" \
  --comment "ãƒ‘ãƒƒãƒé©ç”¨ï¼ˆãƒ­ãƒ¼ãƒªãƒ³ã‚°ï¼‰"

# ========================================
# 5. ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹çŠ¶æ³ã®ç¢ºèª
# ========================================

aws ssm list-compliance-items \
  --resource-ids i-1234567890abcdef0 \
  --resource-types ManagedInstance \
  --filters "Key=ComplianceType,Values=Patch"
```

---

## DOPè©¦é¨“ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### æ¨¡ç¯„è§£ç­”ä»˜ããƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

---

#### 1. Parameter Store vs Secrets Manager ã®ä½¿ã„åˆ†ã‘

<details>
<summary>ğŸ“ æ¨¡ç¯„è§£ç­”ã‚’è¦‹ã‚‹</summary>

| è¦ä»¶ | æ¨å¥¨ã‚µãƒ¼ãƒ“ã‚¹ |
|------|-------------|
| ç’°å¢ƒå¤‰æ•°ã€è¨­å®šå€¤ | Parameter Store (String) |
| APIã‚­ãƒ¼ï¼ˆãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ä¸è¦ï¼‰ | Parameter Store (SecureString) |
| DBãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å¿…è¦ï¼‰ | Secrets Manager |
| RDS/Auroraèªè¨¼æƒ…å ± | Secrets Manager |
| ã‚³ã‚¹ãƒˆé‡è¦– | Parameter Storeï¼ˆç„¡æ–™æ ã‚ã‚Šï¼‰ |
| ã‚¯ãƒ­ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå…±æœ‰ | Secrets Manager |

**è©¦é¨“ã§ã®å‡ºé¡Œä¾‹**:
> ã€Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨­å®šå€¤ã‚’å®‰å…¨ã«ä¿å­˜ã—ã€ç’°å¢ƒã”ã¨ã«ç•°ãªã‚‹å€¤ã‚’ä½¿ã„ãŸã„ã€‚ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆãŸã„å ´åˆã¯ï¼Ÿã€
> â†’ **Parameter Storeï¼ˆéšå±¤åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ç’°å¢ƒã‚’åˆ†é›¢ã€Standard tierã¯ç„¡æ–™ï¼‰**

</details>

---

#### 2. Run Command ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæŒ‡å®šã¨ãƒ¬ãƒ¼ãƒˆåˆ¶å¾¡

<details>
<summary>ğŸ“ æ¨¡ç¯„è§£ç­”ã‚’è¦‹ã‚‹</summary>

**ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæŒ‡å®šã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹**:
- æœ¬ç•ªç’°å¢ƒã§ã¯**ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹**ã§æŒ‡å®šï¼ˆ`Key=tag:Environment,Values=prod`ï¼‰
- ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹IDã®ç›´æ¥æŒ‡å®šã¯é¿ã‘ã‚‹ï¼ˆã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã«æ¬ ã‘ã‚‹ï¼‰

**ãƒ¬ãƒ¼ãƒˆåˆ¶å¾¡ã®è¨­å®š**:
```bash
--max-concurrency "10%"  # åŒæ™‚å®Ÿè¡Œæ•°ã®ä¸Šé™
--max-errors "5%"        # è¨±å®¹ã‚¨ãƒ©ãƒ¼æ•°ã®ä¸Šé™
```

**è©¦é¨“ã§ã®å‡ºé¡Œä¾‹**:
> ã€Œ100å°ã®æœ¬ç•ªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å¯¾ã—ã¦ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã§ãƒ‘ãƒƒãƒã‚’é©ç”¨ã—ãŸã„ã€
> â†’ **Run Command + max-concurrency + max-errors ã§åˆ¶å¾¡**

</details>

---

#### 3. Automation ã®æ‰¿èªãƒ•ãƒ­ãƒ¼ã¨ Change Calendar

<details>
<summary>ğŸ“ æ¨¡ç¯„è§£ç­”ã‚’è¦‹ã‚‹</summary>

**æ‰¿èªãƒ•ãƒ­ãƒ¼ã®å®Ÿè£…**:
- `aws:approve` ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§æ‰‹å‹•æ‰¿èªã‚¹ãƒ†ãƒƒãƒ—ã‚’è¿½åŠ 
- SNSã§æ‰¿èªè€…ã«é€šçŸ¥
- MinRequiredApprovals ã§å¿…è¦ãªæ‰¿èªæ•°ã‚’æŒ‡å®š

**Change Calendar ã¨ã®é€£æº**:
- å¤‰æ›´ç¦æ­¢æœŸé–“ï¼ˆãƒ•ãƒªãƒ¼ã‚ºæœŸé–“ï¼‰ã‚’å®šç¾©
- Automationå®Ÿè¡Œå‰ã«ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’ãƒã‚§ãƒƒã‚¯
- ç¦æ­¢æœŸé–“ä¸­ã¯å®Ÿè¡Œã‚’ãƒ–ãƒ­ãƒƒã‚¯

**è©¦é¨“ã§ã®å‡ºé¡Œä¾‹**:
> ã€Œæœ¬ç•ªç’°å¢ƒã®å¤‰æ›´ã¯å–¶æ¥­æ™‚é–“å¤–ã®ã¿è¨±å¯ã—ãŸã„ã€
> â†’ **Change Calendar ã§å–¶æ¥­æ™‚é–“ã‚’å®šç¾©ã—ã€Automation ã§ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒã‚§ãƒƒã‚¯**

</details>

---

#### 4. Session Manager ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¡ãƒªãƒƒãƒˆ

<details>
<summary>ğŸ“ æ¨¡ç¯„è§£ç­”ã‚’è¦‹ã‚‹</summary>

| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦³ç‚¹ | SSH | Session Manager |
|-----------------|-----|-----------------|
| ãƒãƒ¼ãƒˆé–‹æ”¾ | å¿…è¦ï¼ˆ22ï¼‰ | ä¸è¦ |
| ã‚­ãƒ¼ç®¡ç† | SSHéµã®é…å¸ƒãƒ»ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ | IAMã§ä¸€å…ƒç®¡ç† |
| è¸ã¿å°ã‚µãƒ¼ãƒãƒ¼ | å¿…è¦ | ä¸è¦ |
| ç›£æŸ»ãƒ­ã‚° | åˆ¥é€”è¨­å®š | è‡ªå‹•è¨˜éŒ²ï¼ˆCloudWatch/S3ï¼‰ |
| MFA | è¨­å®šãŒè¤‡é›‘ | IAMã§ç°¡å˜ã«è¨­å®š |

**è©¦é¨“ã§ã®å‡ºé¡Œä¾‹**:
> ã€Œã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒ¼ãƒ ã‹ã‚‰SSHã‚­ãƒ¼ã®ç®¡ç†ã‚’å»ƒæ­¢ã—ãŸã„ã¨è¦æœ›ãŒã‚ã‚‹ã€
> â†’ **Session Manager + IAMã«ã‚ˆã‚‹èªè¨¼ã«ç§»è¡Œ**

</details>

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### SSM Agent ãŒæ¥ç¶šã§ããªã„

```bash
# 1. IAMãƒ­ãƒ¼ãƒ«ã®ç¢ºèª
aws ec2 describe-instances --instance-ids i-xxx \
  --query 'Reservations[0].Instances[0].IamInstanceProfile'

# å¿…è¦ãªãƒãƒªã‚·ãƒ¼: AmazonSSMManagedInstanceCore

# 2. VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ç¢ºèªï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã®å ´åˆï¼‰
aws ec2 describe-vpc-endpoints \
  --filters "Name=service-name,Values=com.amazonaws.ap-northeast-1.ssm"

# 3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã®ç¢ºèª
# ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ã§443ãŒè¨±å¯ã•ã‚Œã¦ã„ã‚‹ã‹

# 4. SSM Agent ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèªï¼ˆEC2å†…ã§å®Ÿè¡Œï¼‰
sudo systemctl status amazon-ssm-agent
sudo journalctl -u amazon-ssm-agent -f
```

---

## ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

| ã‚«ãƒ†ã‚´ãƒª | æ¨å¥¨äº‹é … |
|---------|---------|
| **Parameter Store** | SecureString ã§æ©Ÿå¯†æƒ…å ±ã‚’æš—å·åŒ–ã€éšå±¤åŒ–ã§ç’°å¢ƒã‚’åˆ†é›¢ |
| **Run Command** | ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹ã§ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæŒ‡å®šã€ãƒ¬ãƒ¼ãƒˆåˆ¶å¾¡ã§å®‰å…¨ã«å®Ÿè¡Œ |
| **Automation** | æ‰¿èªãƒ•ãƒ­ãƒ¼ã‚’çµ„ã¿è¾¼ã‚€ã€Change Calendar ã§å¤‰æ›´ç¦æ­¢æœŸé–“ã‚’å®šç¾© |
| **Session Manager** | SSH ã‚’å»ƒæ­¢ã€å…¨ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ãƒ­ã‚°è¨˜éŒ² |
| **Patch Manager** | ãƒ‘ãƒƒãƒãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã§æ‰¿èªãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§è‡ªå‹•åŒ– |

---

## ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

```bash
# Parameter Store
aws ssm delete-parameters --names "/myapp/dev/db-host" "/myapp/dev/db-password"

# ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
aws ssm delete-document --name "MyApp-CreateAndLaunch"

# ãƒ‘ãƒƒãƒãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³
aws ssm delete-patch-baseline --baseline-id pb-xxx
```

---

*ã“ã®ã‚¬ã‚¤ãƒ‰ã¯ DOP-C02 è©¦é¨“å¯¾ç­–ã¨ã—ã¦ã€å®Ÿè·µçš„ãªãƒãƒ³ã‚ºã‚ªãƒ³ã‚’é€šã˜ã¦ Systems Manager ã®å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å­¦ç¿’ã§ãã‚‹æ§‹æˆã«ãªã£ã¦ã„ã¾ã™ã€‚*
