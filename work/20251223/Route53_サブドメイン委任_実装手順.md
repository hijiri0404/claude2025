# Route53 ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³å§”ä»» å®Ÿè£…æ‰‹é †æ›¸

## ğŸ“… ä½œæ¥­æƒ…å ±
- **å®Ÿæ–½æ—¥**: 2025-12-23
- **å¯¾è±¡ãƒ‰ãƒ¡ã‚¤ãƒ³**: hijiri0404.link
- **å§”ä»»ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³**: sub.hijiri0404.link
- **ãƒ†ã‚¹ãƒˆãƒ¬ã‚³ãƒ¼ãƒ‰**: test.sub.hijiri0404.link

---

## ğŸ¯ å®Ÿè£…æ¦‚è¦

è¦ªãƒ‰ãƒ¡ã‚¤ãƒ³ `hijiri0404.link` ã‹ã‚‰ `sub.hijiri0404.link` ã‚’åˆ¥ã®Route53ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ã«å§”ä»»ã—ã€ç‹¬ç«‹ã—ãŸDNSç®¡ç†ã‚’å¯èƒ½ã«ã™ã‚‹è¨­å®šã‚’å®Ÿæ–½ã€‚

---

## ğŸ“‹ å®Ÿè£…æ‰‹é †

### 1ï¸âƒ£ è¦ªãƒ‰ãƒ¡ã‚¤ãƒ³ã®ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³æƒ…å ±ç¢ºèª

```bash
aws route53 list-hosted-zones-by-name --dns-name hijiri0404.link
```

**å–å¾—æƒ…å ±:**
- **ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ID**: `Z05608792OMRUEGE6GF3A`
- **ãƒãƒ¼ãƒ ã‚µãƒ¼ãƒãƒ¼**:
  - ns-2027.awsdns-61.co.uk
  - ns-150.awsdns-18.com
  - ns-713.awsdns-25.net
  - ns-1209.awsdns-23.org

---

### 2ï¸âƒ£ ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ç”¨ã®æ–°ã—ã„ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ä½œæˆ

```bash
aws route53 create-hosted-zone \
  --name sub.hijiri0404.link \
  --caller-reference subdomain-delegation-test-20251223
```

**ä½œæˆã•ã‚ŒãŸãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³:**
- **ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ID**: `Z04428142DRESCQ1V9IJ2`
- **ãƒãƒ¼ãƒ ã‚µãƒ¼ãƒãƒ¼**:
  - ns-1864.awsdns-41.co.uk
  - ns-1351.awsdns-40.org
  - ns-50.awsdns-06.com
  - ns-1016.awsdns-63.net

---

### 3ï¸âƒ£ è¦ªãƒ‰ãƒ¡ã‚¤ãƒ³ã«NSãƒ¬ã‚³ãƒ¼ãƒ‰è¿½åŠ ï¼ˆå§”ä»»è¨­å®šï¼‰

**JSONãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ** (`ns-delegation-change.json`):

```json
{
  "Changes": [
    {
      "Action": "CREATE",
      "ResourceRecordSet": {
        "Name": "sub.hijiri0404.link",
        "Type": "NS",
        "TTL": 300,
        "ResourceRecords": [
          {"Value": "ns-1864.awsdns-41.co.uk"},
          {"Value": "ns-1351.awsdns-40.org"},
          {"Value": "ns-50.awsdns-06.com"},
          {"Value": "ns-1016.awsdns-63.net"}
        ]
      }
    }
  ]
}
```

**NSãƒ¬ã‚³ãƒ¼ãƒ‰è¿½åŠ å®Ÿè¡Œ:**

```bash
aws route53 change-resource-record-sets \
  --hosted-zone-id Z05608792OMRUEGE6GF3A \
  --change-batch file:///tmp/aws-api-mcp/workdir/ns-delegation-change.json
```

**çµæœ:**
- ChangeID: `/change/C07823463K0IRIP5G2VIO`
- Status: `PENDING` â†’ é€šå¸¸60ç§’ä»¥å†…ã«`INSYNC`ã«å¤‰æ›´

---

### 4ï¸âƒ£ ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã«ãƒ†ã‚¹ãƒˆç”¨Aãƒ¬ã‚³ãƒ¼ãƒ‰è¿½åŠ 

**JSONãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ** (`test-a-record.json`):

```json
{
  "Changes": [
    {
      "Action": "CREATE",
      "ResourceRecordSet": {
        "Name": "test.sub.hijiri0404.link",
        "Type": "A",
        "TTL": 300,
        "ResourceRecords": [
          {"Value": "192.0.2.1"}
        ]
      }
    }
  ]
}
```

**Aãƒ¬ã‚³ãƒ¼ãƒ‰è¿½åŠ å®Ÿè¡Œ:**

```bash
aws route53 change-resource-record-sets \
  --hosted-zone-id Z04428142DRESCQ1V9IJ2 \
  --change-batch file:///tmp/aws-api-mcp/workdir/test-a-record.json
```

**çµæœ:**
- ChangeID: `/change/C06749053JMO9W194ZMNY`
- Status: `PENDING`

---

## âœ… å‹•ä½œç¢ºèª

### NSãƒ¬ã‚³ãƒ¼ãƒ‰ç¢ºèª
```bash
dig sub.hijiri0404.link NS +short
```

**çµæœ:**
```
ns-1351.awsdns-40.org.
ns-1864.awsdns-41.co.uk.
ns-50.awsdns-06.com.
ns-1016.awsdns-63.net.
```

âœ… **4ã¤ã®ãƒãƒ¼ãƒ ã‚µãƒ¼ãƒãƒ¼ãŒæ­£ã—ãè¿”ã•ã‚Œã‚‹**

---

### Aãƒ¬ã‚³ãƒ¼ãƒ‰è§£æ±ºç¢ºèª
```bash
dig test.sub.hijiri0404.link A +short
```

**çµæœ:**
```
192.0.2.1
```

âœ… **å§”ä»»ã•ã‚ŒãŸãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ã®Aãƒ¬ã‚³ãƒ¼ãƒ‰ãŒæ­£ã—ãè§£æ±ºã•ã‚Œã‚‹**

---

### å§”ä»»å…ˆãƒãƒ¼ãƒ ã‚µãƒ¼ãƒãƒ¼ã¸ã®ç›´æ¥ã‚¯ã‚¨ãƒª
```bash
dig @ns-1864.awsdns-41.co.uk test.sub.hijiri0404.link A +short
```

**çµæœ:**
```
192.0.2.1
```

âœ… **å§”ä»»å…ˆã®ãƒãƒ¼ãƒ ã‚µãƒ¼ãƒãƒ¼ãŒæ­£ã—ãå¿œç­”**

---

## ğŸ”‘ é‡è¦ãƒã‚¤ãƒ³ãƒˆ

### âœ… æˆåŠŸè¦å› 
1. **NSãƒ¬ã‚³ãƒ¼ãƒ‰ã®æ­£ç¢ºãªè¨­å®š**
   - å§”ä»»å…ˆãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ã®å…¨4ã¤ã®ãƒãƒ¼ãƒ ã‚µãƒ¼ãƒãƒ¼ã‚’æŒ‡å®š
   - TTLã‚’300ç§’ã«è¨­å®šï¼ˆãƒ†ã‚¹ãƒˆç›®çš„ï¼‰

2. **é©åˆ‡ãªãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ç®¡ç†**
   - è¦ªãƒ‰ãƒ¡ã‚¤ãƒ³: å§”ä»»ç”¨NSãƒ¬ã‚³ãƒ¼ãƒ‰ã®ã¿è¿½åŠ 
   - ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³: ç‹¬ç«‹ã—ãŸãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ã§è‡ªç”±ã«ç®¡ç†

3. **SOAãƒ¬ã‚³ãƒ¼ãƒ‰ã®æ‰±ã„**
   - è¦ªãƒ‰ãƒ¡ã‚¤ãƒ³å´ã«ã¯ **SOAãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ãªã„**
   - å§”ä»»å…ˆãŒæ¨©å¨ã‚µãƒ¼ãƒãƒ¼ã¨ãªã‚‹ãŸã‚

### âš ï¸ æ³¨æ„äº‹é …

1. **TTLè¨­å®š**
   - æœ¬ç•ªç’°å¢ƒã§ã¯86400ç§’ï¼ˆ24æ™‚é–“ï¼‰ã‚’æ¨å¥¨
   - ãƒ†ã‚¹ãƒˆæ™‚ã¯300-900ç§’ã§ç´ æ—©ã„å¤‰æ›´ãƒ†ã‚¹ãƒˆãŒå¯èƒ½

2. **DNSãƒ—ãƒ­ãƒ‘ã‚²ãƒ¼ã‚·ãƒ§ãƒ³**
   - å¤‰æ›´ã¯é€šå¸¸60ç§’ä»¥å†…ã«ä¼æ’­
   - ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªå®Œå…¨ä¼æ’­ã«ã¯æœ€å¤§48æ™‚é–“ã‹ã‹ã‚‹å ´åˆã‚ã‚Š

3. **èª²é‡‘ã¸ã®å½±éŸ¿**
   - æ–°ã—ã„ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ã®ä½œæˆã«ã‚ˆã‚Šæœˆé¡$0.50ã®èª²é‡‘ãŒç™ºç”Ÿ
   - ã‚¯ã‚¨ãƒªæ–™é‡‘ã¯é€šå¸¸é€šã‚Š

---

## ğŸ“Š è¨­å®šæ§‹æˆå›³

```
hijiri0404.link (Z05608792OMRUEGE6GF3A)
â”œâ”€â”€ NS: ns-2027.awsdns-61.co.uk
â”œâ”€â”€ NS: ns-150.awsdns-18.com
â”œâ”€â”€ NS: ns-713.awsdns-25.net
â”œâ”€â”€ NS: ns-1209.awsdns-23.org
â””â”€â”€ ã€å§”ä»»ãƒ¬ã‚³ãƒ¼ãƒ‰ã€‘
    â””â”€â”€ sub.hijiri0404.link NS
        â”œâ”€â”€ ns-1864.awsdns-41.co.uk
        â”œâ”€â”€ ns-1351.awsdns-40.org
        â”œâ”€â”€ ns-50.awsdns-06.com
        â””â”€â”€ ns-1016.awsdns-63.net
            â†“ å§”ä»»
sub.hijiri0404.link (Z04428142DRESCQ1V9IJ2)
â”œâ”€â”€ NS: ns-1864.awsdns-41.co.uk
â”œâ”€â”€ NS: ns-1351.awsdns-40.org
â”œâ”€â”€ NS: ns-50.awsdns-06.com
â”œâ”€â”€ NS: ns-1016.awsdns-63.net
â””â”€â”€ test.sub.hijiri0404.link A 192.0.2.1
```

---

## ğŸš€ å¿œç”¨ä¾‹

### ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹1: éƒ¨é–€åˆ¥DNSç®¡ç†
```
example.com
â”œâ”€â”€ sales.example.com    â†’ å–¶æ¥­éƒ¨é–€ãŒç‹¬ç«‹ç®¡ç†
â”œâ”€â”€ dev.example.com      â†’ é–‹ç™ºéƒ¨é–€ãŒç‹¬ç«‹ç®¡ç†
â””â”€â”€ support.example.com  â†’ ã‚µãƒãƒ¼ãƒˆéƒ¨é–€ãŒç‹¬ç«‹ç®¡ç†
```

### ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹2: ç’°å¢ƒåˆ¥åˆ†é›¢
```
mycompany.com
â”œâ”€â”€ prod.mycompany.com   â†’ æœ¬ç•ªç’°å¢ƒï¼ˆå³æ ¼ãªå¤‰æ›´ç®¡ç†ï¼‰
â”œâ”€â”€ staging.mycompany.com â†’ ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ
â””â”€â”€ dev.mycompany.com    â†’ é–‹ç™ºç’°å¢ƒï¼ˆè‡ªç”±ãªå¤‰æ›´ï¼‰
```

### ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹3: åœ°åŸŸåˆ¥åˆ†é›¢
```
global-company.com
â”œâ”€â”€ us.global-company.com     â†’ ç±³å›½ãƒªãƒ¼ã‚¸ãƒ§ãƒ³
â”œâ”€â”€ eu.global-company.com     â†’ æ¬§å·ãƒªãƒ¼ã‚¸ãƒ§ãƒ³
â””â”€â”€ apac.global-company.com   â†’ ã‚¢ã‚¸ã‚¢å¤ªå¹³æ´‹ãƒªãƒ¼ã‚¸ãƒ§ãƒ³
```

---

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### NSãƒ¬ã‚³ãƒ¼ãƒ‰ãŒè¿”ã•ã‚Œãªã„
```bash
# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã¦ç¢ºèª
dig @8.8.8.8 sub.hijiri0404.link NS

# Route53ã®ãƒãƒ¼ãƒ ã‚µãƒ¼ãƒãƒ¼ã«ç›´æ¥å•ã„åˆã‚ã›
dig @ns-2027.awsdns-61.co.uk sub.hijiri0404.link NS
```

### Aãƒ¬ã‚³ãƒ¼ãƒ‰ãŒè§£æ±ºã•ã‚Œãªã„
```bash
# NSãƒ¬ã‚³ãƒ¼ãƒ‰ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
dig sub.hijiri0404.link NS

# å§”ä»»å…ˆãƒãƒ¼ãƒ ã‚µãƒ¼ãƒãƒ¼ã«ç›´æ¥ã‚¯ã‚¨ãƒª
dig @ns-1864.awsdns-41.co.uk test.sub.hijiri0404.link A

# DNSã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ã‚¯ãƒªã‚¢ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒï¼‰
sudo systemd-resolve --flush-caches  # Ubuntu/Debian
```

### å¤‰æ›´ãŒåæ˜ ã•ã‚Œãªã„
```bash
# Route53ã®å¤‰æ›´ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª
aws route53 get-change --id /change/C07823463K0IRIP5G2VIO

# TTLæœŸé–“ï¼ˆ300ç§’ï¼‰å¾…æ©Ÿå¾Œã«å†ç¢ºèª
```

---

## ğŸ“š å‚è€ƒè³‡æ–™

- [AWS Route53 å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ - ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³å§”ä»»](https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/CreatingNewSubdomain.html)
- [RFC 1034 - Domain Names - Concepts and Facilities](https://www.rfc-editor.org/rfc/rfc1034)
- [RFC 1035 - Domain Names - Implementation and Specification](https://www.rfc-editor.org/rfc/rfc1035)

---

## âœ¨ ã¾ã¨ã‚

âœ… **æˆåŠŸã—ãŸé …ç›®:**
1. ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ç”¨ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ä½œæˆ
2. NSãƒ¬ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹å§”ä»»è¨­å®š
3. ãƒ†ã‚¹ãƒˆAãƒ¬ã‚³ãƒ¼ãƒ‰ã®ä½œæˆã¨è§£æ±ºç¢ºèª
4. DNSã‚¯ã‚¨ãƒªã®æ­£å¸¸å‹•ä½œç¢ºèª

ğŸ¯ **é”æˆç›®æ¨™:**
- `sub.hijiri0404.link` ã‚’ç‹¬ç«‹ã—ãŸRoute53ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ã§ç®¡ç†å¯èƒ½ã«
- è¦ªãƒ‰ãƒ¡ã‚¤ãƒ³ã¨ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã®åˆ†é›¢ç®¡ç†ã‚’å®Ÿç¾
- DNSå§”ä»»ã®ä»•çµ„ã¿ã‚’å®Ÿè¨¼

---

**å‚™è€ƒ**: ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯å®Ÿéš›ã®è¨­å®šæ‰‹é †ã«åŸºã¥ã„ã¦ãŠã‚Šã€åŒæ§˜ã®å§”ä»»è¨­å®šã‚’è¡Œã†éš›ã®å‚ç…§ã‚¬ã‚¤ãƒ‰ã¨ã—ã¦æ´»ç”¨ã§ãã¾ã™ã€‚
